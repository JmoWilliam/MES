@using Business_Manager.Helpers
@{
    string itemName = "CustomerManagement";
    string itemNameText = "客戶管理";
    string authority = ViewBag.authority;
}

@Html.Resource("css",
    @<style>
        .form #detailFormCustomerManagement .container {
            margin: 0px;
        }

        .input-group-addon {
            background-color: transparent;
        }

        .btn.sub-function {
            background-color: #fff;
            color: #333;
            border-color: #999;
        }
        .btn.sub-function:focus {
           box-shadow: 0 0 0 0.2rem rgba(200, 200, 200, 0.5);
        }
    </style>
)

<input type="hidden" id="pageAuthority" value="@authority" />

<div class="row">
    <div class="col-12 title-block">
        <h1 class="pt-2 pb-3">@(itemNameText)</h1>
        <div class="unit-block">
            <div class="button-block mb-1">
                <button type="button" class="btn btn-secondary btnReturn" onclick="Return@(itemName)()"><i class="fas fa-undo"></i>返回</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalQuery@(itemName)">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">搜尋</h5>
                <button class="close" data-dismiss="modal" type="button">
                    <span aria-hidden="true"><i class="fas fa-times"></i></span>
                </button>
            </div>
            <div class="modal-body">
                <form class="container" autocomplete="off" id="queryForm@(itemName)">
                    <fieldset>
                        <div class="form-group row">
                            <label class="col-12 form-label" for="txtCustomerNoQ@(itemName)">客戶代號</label>
                            <div class="col-12">
                                <input type="text" class="form-control" id="txtCustomerNoQ@(itemName)" name="txtCustomerNoQ@(itemName)" placeholder="請輸入客戶代號" />
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 form-label" for="txtCustomerNameQ@(itemName)">客戶名稱</label>
                            <div class="col-12">
                                <input type="text" class="form-control" id="txtCustomerNameQ@(itemName)" name="txtCustomerNameQ@(itemName)" placeholder="請輸入客戶名稱" />
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 form-label">狀態</label>
                            <div class="col-lg-3 col-md-4 col-6">
                                <label class="control control-solid control-solid-info control--checkbox col-12">
                                    啟用
                                    <input type="checkbox" id="cbxStatusQ@(itemName)A" name="cbxStatusQ@(itemName)" value="A" checked />
                                    <span class="control__indicator"></span>
                                </label>
                            </div>
                            <div class="col-lg-3 col-md-4 col-6">
                                <label class="control control-solid control-solid-info control--checkbox col-12">
                                    停用
                                    <input type="checkbox" id="cbxStatusQ@(itemName)S" name="cbxStatusQ@(itemName)" value="S" />
                                    <span class="control__indicator"></span>
                                </label>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="Query@(itemName)()" style="margin: auto;"><i class="fal fa-wrench"></i>套用</button>
            </div>
        </div>
    </div>
</div>

<div class="row" id="listData@(itemName)">
    <div class="col-12">
        <div class="card card-shadow mb-4">
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-6 col-sm-6 col-md-6">
                        <a class="btn btn-primary" data-backdrop="static" data-keyboard="false" data-toggle="modal" data-target="#modalQuery@(itemName)" href="javascript:void(0);">
                        <i class="fal fa-search"></i>搜尋</a>
                    </div>
                    <div class="col-6 col-sm-6 col-md-6 text-right">
                        <a class="btn btn-info auth-add" href="javascript:Edit@(itemName)();"><i class="fas fa-plus"></i>新增</a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="table-custom">
                            <table class="table table-bordered table-striped table-sticky" id="tblData@(itemName)">
                                <thead>
                                    <tr>
                                        <th scope="col" style="min-width: 75px;">#</th>
                                        <th scope="col" style="min-width: 100px;">客戶代號</th>
                                        <th scope="col" style="min-width: 150px;">客戶名稱</th>
                                        <th scope="col" style="min-width: 170px;">連絡電話</th>
                                        <th scope="col" style="min-width: 200px;">地址</th>
                                        <th scope="col" style="min-width: 150px;">客戶聯絡人</th>
                                        <th scope="col" style="min-width: 175px;">業務負責人</th>
                                        <th class="text-center" scope="col" style="min-width: 100px;">拋轉ERP</th>
                                        <th class="text-center" scope="col" style="min-width: 125px;">狀態</th>
                                        <th class="text-center" scope="col" style="min-width: 125px;">操作</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <div class="pagination" id="page@(itemName)"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row" id="editData@(itemName)" style="display: none;">
    <div class="col-12">
        <div class="card card-shadow mb-4">
            <div class="card-body">
                <form class="container" autocomplete="off" id="editForm@(itemName)">
                    <fieldset>
                        <input type="hidden" id="CustomerId" name="CustomerId" value="-1" />
                        <div class="row">
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="form-label col-12" for="txtCustomerNo@(itemName)">客戶代號 <span class="text-danger">*</span></label>
                                    <div class="col-12">
                                        <input type="text" class="form-control" id="txtCustomerNo@(itemName)" name="txtCustomerNo@(itemName)"
                                               data-msg-required="請輸入客戶代號" data-rule-required="true" placeholder="請輸入客戶代號"
                                               data-msg-maxlength="必須少於 50 個字元" maxlength="50" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="form-label col-12" for="txtCustomerName@(itemName)">客戶名稱 <span class="text-danger">*</span></label>
                                    <div class="col-12">
                                        <input type="text" class="form-control" id="txtCustomerName@(itemName)" name="txtCustomerName@(itemName)"
                                               data-msg-required="請輸入客戶名稱" data-rule-required="true" placeholder="請輸入客戶名稱"
                                               data-msg-maxlength="必須少於 200 個字元" maxlength="200" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="form-label col-12" for="txtCustomerEnglishName@(itemName)">英文名稱 </label>
                                    <div class="col-12">
                                        <input type="text" class="form-control" id="txtCustomerEnglishName@(itemName)" name="txtCustomerEnglishName@(itemName)"
                                               data-msg-maxlength="必須少於 80 個字元" maxlength="80" placeholder="請輸入英文名稱" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="form-label col-12" for="txtCustomerShortName@(itemName)">客戶簡稱 <span class="text-danger">*</span></label>
                                    <div class="col-12">
                                        <input type="text" class="form-control" id="txtCustomerShortName@(itemName)" name="txtCustomerShortName@(itemName)"
                                               data-msg-required="請輸入客戶簡稱" data-rule-required="true" placeholder="請輸入客戶簡稱"
                                               data-msg-maxlength="必須少於 100 個字元" maxlength="100" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-4">
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="form-label col-12" for="cboRelatedPerson@(itemName)">關係人代號 </label>
                                    <div class="col-12">
                                        <select class="form-control" id="cboRelatedPerson@(itemName)" name="cboRelatedPerson@(itemName)"
                                                data-msg-required="請選擇關係人代號"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-9">
                                <div class="form-group row">
                                    <label class="form-label col-12" for="txtPermitDate@(itemName)">客戶核准日 </label>
                                    <div class="input-group col-12">
                                        <input type="text" class="form-control datedropper" id="txtPermitDate@(itemName)" name="txtPermitDate@(itemName)"
                                               data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                                placeholder="請輸入客戶核准日" readonly />
                                        <div class="input-group-append">
                                            <button type="button" class="btn btn-outline-danger" onclick="$('#txtPermitDate@(itemName)').val('')" title="清除">
                                            <i class="fas fa-eraser"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-2 col-md-3">
                                <div class="form-group row">
                                    <label class="form-label col-12" for="txtVersion@(itemName)">版次 </label>
                                    <div class="col-12">
                                        <input type="text" class="form-control" id="txtVersion@(itemName)" name="txtVersion@(itemName)" placeholder="0000" readonly />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab" style="white-space:unset;">
                            <ul class="nav nav-tabs nav-fill mb-3" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="tabActive" data-toggle="tab" href="#tabBasic1">
                                        <i class="fas fa-clipboard"></i> 基本資料(一)
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#tabBasic2">
                                        <i class="fas fa-folder"></i> 基本資料(二)
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#tabTrade1">
                                        <i class="fas fa-hand-holding-usd"></i> 交易資料(一)
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#tabTrade2">
                                        <i class="fas fa-hands-usd"></i> 交易資料(二)
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#tabCredit">
                                        <i class="fab fa-cc-visa"></i> 信用額度
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabBasic1">
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtResponsiblePerson@(itemName)">負責人 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtResponsiblePerson@(itemName)" name="txtResponsiblePerson@(itemName)"
                                                       data-msg-required="請輸入負責人" data-rule-required="true" placeholder="請輸入負責人"
                                                       data-msg-maxlength="必須少於 30 個字元" maxlength="30" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtContact@(itemName)">聯絡人 </label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtContact@(itemName)" name="txtContact@(itemName)"
                                                       data-msg-maxlength="必須少於 30 個字元" maxlength="30" placeholder="請輸入聯絡人" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtTelNoFirst@(itemName)">電話(一) <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtTelNoFirst@(itemName)" name="txtTelNoFirst@(itemName)"
                                                       data-msg-required="請輸入電話(一)" data-rule-required="true" placeholder="請輸入電話(一)"
                                                       data-msg-maxlength="必須少於 20 個字元" maxlength="20" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtTelNoSecond@(itemName)">電話(二) </label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtTelNoSecond@(itemName)" name="txtTelNoSecond@(itemName)"
                                                       data-msg-maxlength="必須少於 20 個字元" maxlength="20" placeholder="請輸入電話(二)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtFaxNo@(itemName)">客戶傳真 </label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtFaxNo@(itemName)" name="txtFaxNo@(itemName)"
                                                       data-msg-maxlength="必須少於 20 個字元" maxlength="20" placeholder="請輸入客戶傳真" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtEmail@(itemName)">電子郵件 </label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtEmail@(itemName)" name="txtEmail@(itemName)"
                                                       data-msg-maxlength="必須少於 60 個字元" maxlength="60" placeholder="請輸入電子郵件" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtGuiNumber@(itemName)">統一編號 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtGuiNumber@(itemName)" name="txtGuiNumber@(itemName)"
                                                       data-msg-required="請輸入統一編號" data-rule-required="true"
                                                       data-msg-maxlength="必須少於 20 個字元" maxlength="20" placeholder="請輸入統一編號" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtCapital@(itemName)">資本額 <span class="text-danger">*</span></label>
                                            <div class="input-group col-12">
                                                <input type="number" class="form-control" id="txtCapital@(itemName)" name="txtCapital@(itemName)" value="0" min="0"
                                                       data-msg-required="請輸入資本額" data-rule-required="true" />
                                                <span class="input-group-addon">萬</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtAnnualTurnover@(itemName)">年營業額 <span class="text-danger">*</span></label>
                                            <div class="input-group col-12">
                                                <input type="number" class="form-control" id="txtAnnualTurnover@(itemName)" name="txtAnnualTurnover@(itemName)" value="0" min="0"
                                                       data-msg-required="請輸入年營業額" data-rule-required="true" />
                                                <span class="input-group-addon">萬</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtHeadcount@(itemName)">員工人數 <span class="text-danger">*</span></label>
                                            <div class="input-group col-12">
                                                <input type="number" class="form-control" id="txtHeadcount@(itemName)" name="txtHeadcount@(itemName)" value="0" min="0"
                                                       data-msg-required="請輸入員工人數" data-rule-required="true" />
                                                <span class="input-group-addon">人</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtHomeOffice@(itemName)">總店號 </label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtHomeOffice@(itemName)" name="txtHomeOffice@(itemName)"
                                                       data-msg-maxlength="必須少於 10 個字元" maxlength="10" placeholder="請輸入總店號" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboCurrency@(itemName)">交易幣別 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboCurrency@(itemName)" name="cboCurrency@(itemName)"
                                                        data-msg-required="請選擇交易幣別" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboDepartmentId@(itemName)">部門別 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboDepartmentId@(itemName)" name="cboDepartmentId@(itemName)"
                                                        data-msg-required="請選擇部門別" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboCustomerKind@(itemName)">客戶分類 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboCustomerKind@(itemName)" name="cboCustomerKind@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboSalesmenId@(itemName)">業務人員 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboSalesmenId@(itemName)" name="cboSalesmenId@(itemName)"
                                                        data-msg-required="請選擇業務人員" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboPaymentSalesmenId@(itemName)">收款業務員 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboPaymentSalesmenId@(itemName)" name="cboPaymentSalesmenId@(itemName)"
                                                        data-msg-required="請選擇收款業務員" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtInauguateDate@(itemName)">開業日期 </label>
                                            <div class="input-group col-12">
                                                <input type="text" class="form-control datedropper" id="txtInauguateDate@(itemName)" name="txtInauguateDate@(itemName)"
                                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                                       placeholder="請輸入開業日期" readonly />
                                                <div class="input-group-append">
                                                    <button type="button" class="btn btn-outline-danger" onclick="$('#txtInauguateDate@(itemName)').val('')" title="清除">
                                                    <i class="fas fa-eraser"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtCloseDate@(itemName)">歇業日期 </label>
                                            <div class="input-group col-12">
                                                <input type="text" class="form-control datedropper" id="txtCloseDate@(itemName)" name="txtCloseDate@(itemName)"
                                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                                       placeholder="請輸入歇業日期" readonly />
                                                <div class="input-group-append">
                                                    <button type="button" class="btn btn-outline-danger" onclick="$('#txtCloseDate@(itemName)').val('')" title="清除">
                                                    <i class="fas fa-eraser"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabBasic2">
                                <div class="row">
                                    <div class="col-lg-12 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="chkInvocieAttachedStatus@(itemName)">隨貨附上發票 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <div class="row">
                                                    <div class="col-lg-3 col-md-4 col-6">
                                                        <label class="control control-solid control-solid-info control--radio col-12">
                                                            是
                                                            <input type="radio" id="chkInvocieAttachedStatus@(itemName)Y" name="chkInvocieAttachedStatus@(itemName)" value="Y" data-msg-required="請選擇是否隨貨附上發票" data-rule-required="true" checked />
                                                            <span class="control__indicator"></span>
                                                        </label>
                                                    </div>
                                                    <div class="col-lg-3 col-md-4 col-6">
                                                        <label class="control control-solid control-solid-info control--radio col-12">
                                                            否
                                                            <input type="radio" id="chkInvocieAttachedStatus@(itemName)N" name="chkInvocieAttachedStatus@(itemName)" value="N" data-msg-required="請選擇是否隨貨附上發票" data-rule-required="true" />
                                                            <span class="control__indicator"></span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtZipCodeRegister@(itemName)">登記地址(中文) <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtZipCodeRegister@(itemName)" name="txtZipCodeRegister@(itemName)"
                                                       data-msg-maxlength="必須少於 6 個字元" maxlength="6" placeholder="請輸入郵遞區號" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            <label class="form-label col-12">&nbsp</label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtRegisterAddressFirst@(itemName)" name="txtRegisterAddressFirst@(itemName)"
                                                       data-msg-required="請輸入登記地址" data-rule-required="true" placeholder="請輸入登記地址(一)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3"></div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            @*<label class="form-label col-12" for="txtRegisterAddressSecond@(itemName)">登記地址(英文) </label>*@
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtRegisterAddressSecond@(itemName)" name="txtRegisterAddressSecond@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" placeholder="請輸入登記地址(二)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtZipCodeInvoice@(itemName)">發票地址(中文) <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtZipCodeInvoice@(itemName)" name="txtZipCodeInvoice@(itemName)"
                                                       data-msg-maxlength="必須少於 6 個字元" maxlength="6" placeholder="請輸入郵遞區號" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            <label class="form-label col-12">&nbsp</label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtInvoiceAddressFirst@(itemName)" name="txtInvoiceAddressFirst@(itemName)"
                                                       data-msg-required="請輸入發票地址" data-rule-required="true" placeholder="請輸入發票地址(一)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3"></div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            @*<label class="form-label col-12" for="txtInvoiceAddressSecond@(itemName)">發票地址(英文) </label>*@
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtInvoiceAddressSecond@(itemName)" name="txtInvoiceAddressSecond@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" placeholder="請輸入發票地址(二)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3">
                                        <div class="form-group row">
                                            <label class="col-12 form-label" for="txtZipCodeDelivery@(itemName)">送貨地址(中文) <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtZipCodeDelivery@(itemName)" name="txtZipCodeDelivery@(itemName)"
                                                       data-msg-maxlength="必須少於 6 個字元" maxlength="6" placeholder="請輸入郵遞區號" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            <label class="form-label col-12">&nbsp</label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtDeliveryAddressFirst@(itemName)" name="txtDeliveryAddressFirst@(itemName)"
                                                       data-msg-required="請輸入送貨地址" data-rule-required="true"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" placeholder="請輸入送貨地址(一)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3"></div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            @*<label class="form-label col-12" for="txtDeliveryAddressSecond@(itemName)">送貨地址(英文) </label>*@
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtDeliveryAddressSecond@(itemName)" name="txtDeliveryAddressSecond@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" placeholder="請輸入送貨地址(二)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3">
                                        <div class="form-group row">
                                            <label class="col-12 form-label" for="txtZipCodeDocument@(itemName)">文件地址(中文) <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtZipCodeDocument@(itemName)" name="txtZipCodeDocument@(itemName)"
                                                       data-msg-maxlength="必須少於 6 個字元" maxlength="6" placeholder="請輸入郵遞區號" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            <label class="form-label col-12">&nbsp</label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtDocumentAddressFirst@(itemName)" name="txtDocumentAddressFirst@(itemName)"
                                                       data-msg-required="請輸入文件地址" data-rule-required="true" placeholder="請輸入文件地址(一)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3"></div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            @*<label class="form-label col-12" for="txtDocumentAddressSecond@(itemName)">文件地址(英文) </label>*@
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtDocumentAddressSecond@(itemName)" name="txtDocumentAddressSecond@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" placeholder="請輸入文件地址(二)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12 col-md-12">
                                        <div class="form-group row">
                                            <label class="col-12 form-label" for="txtBillReceipient@(itemName)">帳單收件人 </label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtBillReceipient@(itemName)" name="txtBillReceipient@(itemName)"
                                                       data-msg-maxlength="必須少於 30 個字元" maxlength="30" placeholder="請輸入帳單收件人" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3">
                                        <div class="form-group row">
                                            <label class="col-12 form-label" for="txtZipCodeBill@(itemName)">帳單地址(中文) <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtZipCodeBill@(itemName)" name="txtZipCodeBill@(itemName)"
                                                       data-msg-maxlength="必須少於 6 個字元" maxlength="6" placeholder="請輸入郵遞區號" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            <label class="form-label col-12">&nbsp</label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtBillAddressFirst@(itemName)" name="txtBillAddressFirst@(itemName)"
                                                       data-msg-required="請輸入帳單地址" data-rule-required="true"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" placeholder="請輸入帳單地址(一)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-3 col-md-3"></div>
                                    <div class="col-lg-9 col-md-9">
                                        <div class="form-group row">
                                            @*<label class="form-label col-12" for="txtBillAddressSecond@(itemName)">帳單地址(英文) </label>*@
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtBillAddressSecond@(itemName)" name="txtBillAddressSecond@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="255" placeholder="請輸入帳單地址(二)" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabTrade1">
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtDepositRate@(itemName)">訂金比率 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="number" class="form-control" id="txtDepositRate@(itemName)" name="txtDepositRate@(itemName)" placeholder="請輸入訂金比率"
                                                       data-msg-required="請輸入訂金比率" data-rule-required="true"
                                                       step="0.01" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboTaxAmountCalculateType@(itemName)">稅額計算方式 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboTaxAmountCalculateType@(itemName)" name="cboTaxAmountCalculateType@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboSaleRating@(itemName)">銷售評等 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboSaleRating@(itemName)" name="cboSaleRating@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboCreditRating@(itemName)">信用評等 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboCreditRating@(itemName)" name="cboCreditRating@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboTradeTerm@(itemName)">交易條件 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboTradeTerm@(itemName)" name="cboTradeTerm@(itemName)"
                                                        data-msg-required="請選擇交易條件" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboPaymentTerm@(itemName)">付款條件 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboPaymentTerm@(itemName)" name="cboPaymentTerm@(itemName)"
                                                        data-msg-required="請選擇付款條件" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboPricingType@(itemName)">計價方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboPricingType@(itemName)" name="cboPricingType@(itemName)"
                                                        data-msg-required="請選擇計價方式" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboClearanceType@(itemName)">通關方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboClearanceType@(itemName)" name="cboClearanceType@(itemName)"
                                                        data-msg-required="請選擇通關方式" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboDocumentDeliver@(itemName)">採購單發送方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboDocumentDeliver@(itemName)" name="cboDocumentDeliver@(itemName)"
                                                        data-msg-required="請選擇採購單發送方式" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboReceiptReceive@(itemName)">票據寄領 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboReceiptReceive@(itemName)" name="cboReceiptReceive@(itemName)"
                                                        data-msg-required="請選擇票據寄領" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboPaymentType@(itemName)">收款方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboPaymentType@(itemName)" name="cboPaymentType@(itemName)"
                                                        data-msg-required="請選擇收款方式" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboTaxNo@(itemName)">稅別碼 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboTaxNo@(itemName)" name="cboTaxNo@(itemName)"
                                                        data-msg-required="請選擇稅別碼" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboInvoiceCount@(itemName)">發票聯數 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboInvoiceCount@(itemName)" name="cboInvoiceCount@(itemName)"
                                                        data-msg-required="請選擇發票聯數" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboTaxation@(itemName)">課稅別 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboTaxation@(itemName)" name="cboTaxation@(itemName)"
                                                        data-msg-required="請選擇課稅別" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabTrade2">
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboCountry@(itemName)">國家別 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboCountry@(itemName)" name="cboCountry@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboRegion@(itemName)">地區別 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboRegion@(itemName)" name="cboRegion@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboRoute@(itemName)">路線別 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboRoute@(itemName)" name="cboRoute@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboUploadType@(itemName)">上傳類型 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboUploadType@(itemName)" name="cboUploadType@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row bank-account">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboPaymentBankFirst@(itemName)">付款銀行(一) </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboPaymentBankFirst@(itemName)" name="cboPaymentBankFirst@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtBankAccountFirst@(itemName)">銀行帳號(一) </label>
                                            <div class="input-group col-12">
                                                <input type="text" class="form-control" id="txtBankAccountFirst@(itemName)" name="txtBankAccountFirst@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="20" placeholder="請輸入銀行帳號(一)" />
                                                <div class="input-group-append">
                                                    <button type="button" class="btn btn-success BankAccount" onclick="AddBank@(itemName)()" title="新增銀行"><i class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row bank-account" style="display: none;">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboPaymentBankSecond@(itemName)">付款銀行(二) </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboPaymentBankSecond@(itemName)" name="cboPaymentBankSecond@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtBankAccountSecond@(itemName)">銀行帳號(二) </label>
                                            <div class="input-group col-12">
                                                <input type="text" class="form-control" id="txtBankAccountSecond@(itemName)" name="txtBankAccountSecond@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="20" placeholder="請輸入銀行帳號(二)" />
                                                <div class="input-group-append">
                                                    <button type="button" class="btn btn-danger BankAccount" onclick="DeleteBank@(itemName)(1)" title="刪除銀行(二)"><i class="fas fa-minus mt-1"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row bank-account" style="display: none;">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboPaymentBankThird@(itemName)">付款銀行(三) </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboPaymentBankThird@(itemName)" name="cboPaymentBankThird@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtBankAccountThird@(itemName)">銀行帳號(三) </label>
                                            <div class="input-group col-12">
                                                <input type="text" class="form-control" id="txtBankAccountThird@(itemName)" name="txtBankAccountThird@(itemName)"
                                                       data-msg-maxlength="必須少於 255 個字元" maxlength="20" placeholder="請輸入銀行帳號(三)" />
                                                <div class="input-group-append">
                                                    <button type="button" class="btn btn-danger BankAccount" onclick="DeleteBank@(itemName)(2)" title="刪除銀行(三)"><i class="fas fa-minus mt-1"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboAccount@(itemName)">帳款科目 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboAccount@(itemName)" name="cboAccount@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboAccountInvoice@(itemName)">票據科目 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboAccountInvoice@(itemName)" name="cboAccountInvoice@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtAccountDay@(itemName)">結帳日期 </label>
                                            <div class="input-group col-12">
                                                <span class="input-group-addon">每月</span>
                                                <input type="number" class="form-control" id="txtAccountDay@(itemName)" name="txtAccountDay@(itemName)" 
                                                       min="1" max="31" placeholder="請輸入結帳日期"/>
                                                <span class="input-group-addon">日</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboShipMethod@(itemName)">運輸方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboShipMethod@(itemName)" name="cboShipMethod@(itemName)"
                                                        data-msg-required="請選擇運輸方式" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboShipType@(itemName)">運輸種類 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboShipType@(itemName)" name="cboShipType@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboForwarderId@(itemName)">貨運承攬商 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboForwarderId@(itemName)" name="cboForwarderId@(itemName)"
                                                        data-msg-required="請選擇貨運承攬商" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtCustomerRemark@(itemName)">備註 </label>
                                            <div class="col-12">
                                                <textarea class="form-control" id="txtCustomerRemark@(itemName)" name="txtCustomerRemark@(itemName)"
                                                          data-msg-maxlength="必須少於 255 個字元" maxlength="255" rows="2" placeholder="請輸入備註"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabCredit">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="txtCreditLimit@(itemName)">信用額度 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <input type="text" class="form-control" id="txtCreditLimit@(itemName)" name="txtCreditLimit@(itemName)" placeholder="請輸入信用額度" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboCreditLimitControl@(itemName)">信用額度管制 </label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboCreditLimitControl@(itemName)" name="cboCreditLimitControl@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboCreditLimitControlCurrency@(itemName)">信用額度控管幣別 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboCreditLimitControlCurrency@(itemName)" name="cboCreditLimitControlCurrency@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboSoCreditAuditType@(itemName)">訂單信用查核方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboSoCreditAuditType@(itemName)" name="cboSoCreditAuditType@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboSSiCreditAuditType@(itemName)">銷貨信用查核方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboSSiCreditAuditType@(itemName)" name="cboSSiCreditAuditType@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboDoCreditAuditType@(itemName)">出貨通知查核方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboDoCreditAuditType@(itemName)" name="cboDoCreditAuditType@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="form-label col-12" for="cboInTransitCreditAuditType@(itemName)">暫出單信用查核方式 <span class="text-danger">*</span></label>
                                            <div class="col-12">
                                                <select class="form-control" id="cboInTransitCreditAuditType@(itemName)" name="cboInTransitCreditAuditType@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="card-footer text-right">
                <button type="button" class="btn sub-function btnPrev" onclick="Prev@(itemName)()" style="display:none;"><i class="fas fa-arrow-alt-circle-left"></i>上一步</button>
                <button type="button" class="btn btn-info btnNext" onclick="Next@(itemName)()"><i class="fas fa-arrow-alt-circle-right"></i>下一步</button>
                <button type="button" class="btn btn-success btnSave readSave" onclick="Save@(itemName)()" style="display:none;"><i class="fas fa-save"></i>儲存</button>
            </div>
        </div>
    </div>
</div>

@Html.Resource("js",
    @<script>
        let objPage@(itemName) = {
            "pageIndex": 0,
            "pageSize": 10
        };
        let objForm@(itemName) = "#editForm@(itemName)";
        let displayBank = [1, 0, 0];

        $(document).ready(function () {

            Query@(itemName)();

            $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
                switch ($(this).attr("href")) {
                    case "#tabBasic1":
                        //$(".btnReturn").show();
                        $(".btnPrev").hide();
                        $(".btnNext").show();
                        $(".btnSave").hide();
                        break;
                    case "#tabCredit":
                        //$(".btnReturn").hide();
                        $(".btnPrev").show();
                        $(".btnNext").hide();
                        if ($(objForm@(itemName) + " fieldset").attr("disabled") == 'disabled') {
                            $(".btnSave").hide();
                        } else {
                            $(".btnSave").show();
                        }
                        break;
                    default:
                        //$(".btnReturn").hide();
                        $(".btnReturn").show();
                        $(".btnPrev").show();
                        $(".btnNext").show();
                        $(".btnSave").hide();
                        break;
                }
            });
            
        });

        function Query@(itemName)() {
            objPage@(itemName).pageIndex = 0;
            InitData@(itemName)(objPage@(itemName));

            $("#modalQuery@(itemName)").modal("hide");
        }

        function InitData@(itemName)(objPage) {
            let innerHtml = '';
            let pageCount = 0;
            
            let statusList = [];
            $.each($("input[name='cbxStatusQ@(itemName)']:checked"), function () {
                statusList.push($(this).val());
            });

            let targetUrl = "@Url.Action("GetCustomer", "ScmBasicInformation")";
            let postData = {
                "OrderBy": "",
                "PageIndex": (objPage.pageIndex + 1),
                "PageSize": objPage.pageSize,
                "CustomerNo": $("#txtCustomerNoQ@(itemName)").val(),
                "CustomerName": $("#txtCustomerNameQ@(itemName)").val(),
                "Status": statusList.join(",")
            };
            let data = DataAccess.Get(targetUrl, postData, false);

            if (data.status == "success") {
                pageCount = data.result.length > 0 ? parseInt(data.result[0]["TotalCount"]) : 0;

                if (pageCount > 0) {
                    objPage = PageCaculate(pageCount, objPage);

                    $.each(data.result, function (i, item) {
                        let _row = (objPage.pageSize * objPage.pageIndex + (i + 1)) + ".";

                        innerHtml += `<tr>
                                        <td>${_row}</td>
                                        <td>${item.CustomerNo}</td>
                                        <td class="ellipsis" data-toggle="tooltip" title="${item.CustomerName}" style="max-width: 150px;">${item.CustomerShortName}</td>
                                        <td>${item.TelNoFirst}</td>
                                        <td class="ellipsis" data-toggle="tooltip" title="${item.RegisterAddressFirst}" style="max-width: 150px;">${item.RegisterAddressFirst}</td>
                                        <td>${item.Contact}</td>
                                        <td><i class="fas fa-user"></i>&nbsp;<code>${item.SalesmenNo}</code>&nbsp;${item.SalesmenName}</td>
                                        <td class="text-center">${StatusName("Boolean", item.TransferStatus)}</td>
                                        <td class="text-center auth-status-switch">
                                          <input type="checkbox" name="chkStatus@(itemName)" data-customer-id="${item.CustomerId}" ${(item.Status == 'A' ? 'checked' : '')} />
                                        </td>
                                        <td class="text-center un-auth auth-status-switch">${StatusName("Status", item.Status)}</td>
                                        <td class="text-center active-content">
                                          <a class="active-link auth-read" href="javascript:Read@(itemName)(${item.CustomerId});"><i class="fas fa-eye"></i></a>
                                          <a class="active-link auth-update" href="javascript:Edit@(itemName)(${item.CustomerId});"><i class="fas fa-edit"></i></a>
                                        </td>
                                      </tr>`;
                    });
                } else {
                    innerHtml += `<tr>
                                    <td class="text-center" colspan="10" style="background-color: #fff3cd;">
                                      <i class="fal fa-exclamation-circle"></i>&nbsp;目前尚無資料。
                                    </td>
                                  </tr>`;
                }
            } else {
                alert(data.msg, "alert", 0);
            }

            $("#tblData@(itemName) tbody").html(innerHtml);
            TableComponentInit();
            Pager("#page@(itemName)", pageCount, objPage, InitData@(itemName));

            $("input[name='chkStatus@(itemName)']").bootstrapToggle({
                on: "啟用",
                off: "停用",
                onstyle: "success",
                offstyle: "danger",
                size: "mini"
            });

            $("input[name='chkStatus@(itemName)'][data-customer-id]").change(StatusSwitch@(itemName));
        }

        function Edit@(itemName)(CustomerId) {
            $("#CustomerId").val(CustomerId ? CustomerId : 0);

            $(objForm@(itemName) + " fieldset").attr("disabled", false);
            $(objForm@(itemName) + " select").attr("disabled", false);

            $("#cboInvoiceCount@(itemName)").attr("disabled", true);
            $("#cboTaxation@(itemName)").attr("disabled", true);
            $("#txtCustomerNo@(itemName)").attr("readonly", false);
            $(".BankAccount").show();
            $(".btn-outline-danger").show();
            $(".nav-item > a.nav-link i").eq(0).click();
            
            DeleteBank@(itemName)(1);
            DeleteBank@(itemName)(2);

            Switch("#editData@(itemName), .unit-block", "#listData@(itemName)");

            ComboBoxs.WithText("#cboRelatedPerson@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "RelatedPerson" }, "", "NA", "", "SubsidiaryName", "RelatedPerson");  //關係人代號
            ComboBoxs.WithText("#cboCurrency@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "Currency" }, "", "NA", "", "CurrencyName", "Currency");  //交易幣別
            ComboBoxs.Default("#cboDepartmentId@(itemName)", "@Url.Action("GetDepartment", "BasicInformation")", { "Status": "A" }, "106", "NA", "", "DepartmentName", "DepartmentId");  //部門別
            ComboBoxs.Default("#cboCustomerKind@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.CustomerKind" }, "", "NA", "", "TypeName", "TypeNo");//客戶分類
            ComboBoxs.Default("#cboSalesmenId@(itemName)", "@Url.Action("GetUser", "BasicInformation")", { "Departments": "106,107,110" }, "", "NA", "", "UserWithNo", "UserId");  //業務人員
            ComboBoxs.Default("#cboPaymentSalesmenId@(itemName)", "@Url.Action("GetUser", "BasicInformation")", { "Departments": "106,107,110" }, "", "NA", "", "UserWithNo", "UserId");  //收款業務員
            ComboBoxs.Default("#cboTaxAmountCalculateType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.TaxAmountCalculate" }, "", "NA", "", "TypeName", "TypeNo");  //稅額計算方式
            ComboBoxs.Default("#cboSaleRating@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Rating" }, "", "NA", "", "TypeName", "TypeNo");  //銷售評等
            ComboBoxs.Default("#cboCreditRating@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Rating" }, "", "NA", "", "TypeName", "TypeNo");    //信用評等
            ComboBoxs.Default("#cboTradeTerm@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TradeTerm" }, "1", "NA", "", "TradeTermName", "TradeTermNo");  //交易條件
            ComboBoxs.Default("#cboPaymentTerm@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "PaymentTerm" }, "", "NA", "", "PaymentTermName", "PaymentTermNo");  //付款條件
            ComboBoxs.Default("#cboPricingType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Pricing" }, "", "NA", "", "TypeName", "TypeNo");    //計價方式
            ComboBoxs.Default("#cboClearanceType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Clearance" }, "", "NA", "", "TypeName", "TypeNo");    //通關方式
            ComboBoxs.Default("#cboDocumentDeliver@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Deliver" }, "", "NA", "", "TypeName", "TypeNo");    //採購單發送方式
            ComboBoxs.Default("#cboReceiptReceive@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.ReceiptReceive" }, "", "NA", "", "TypeName", "TypeNo");    //票據寄領
            ComboBoxs.Default("#cboPaymentType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Payment" }, "", "NA", "", "TypeName", "TypeNo");    //收款方式
            ComboBoxs.WithText("#cboTaxNo@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TaxNo" }, "", "NA", "", "TaxName", "TaxNo");  //稅別碼
            ComboBoxs.Default("#cboCountry@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TransactionObject", "Condition": 4 }, "", "NA", "", "ClassificationName", "ClassificationNo");    //國家別
            ComboBoxs.Default("#cboRegion@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TransactionObject", "Condition": 3 }, "", "NA", "", "ClassificationName", "ClassificationNo");    //地區別
            ComboBoxs.Default("#cboRoute@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TransactionObject", "Condition": 5 }, "", "NA", "", "ClassificationName", "ClassificationNo");    //路線別
            ComboBoxs.Default("#cboUploadType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.UploadType" }, "", "NA", "", "TypeName", "TypeNo");    //上傳類型
            ComboBoxs.Default("#cboPaymentBankFirst@(itemName)", "@Url.Action("GetErpSysData", "BasicInformation")", { "ColumnName": "Bank" }, "", "NA", "", "BankName", "BankNo");    //付款銀行(一)
            ComboBoxs.Default("#cboPaymentBankSecond@(itemName)", "@Url.Action("GetErpSysData", "BasicInformation")", { "ColumnName": "Bank" }, "", "NA", "", "BankName", "BankNo");    //付款銀行(二)
            ComboBoxs.Default("#cboPaymentBankThird@(itemName)", "@Url.Action("GetErpSysData", "BasicInformation")", { "ColumnName": "Bank" }, "", "NA", "", "BankName", "BankNo");    //付款銀行(三)
            ComboBoxs.Default("#cboAccount@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "Account" }, "", "NA", "", "AccountName", "AccountNo");    //帳款科目            
            ComboBoxs.Default("#cboAccountInvoice@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "AccountInvoice" }, "", "NA", "", "AccountName", "AccountNo");    //票據科目            
            ComboBoxs.Default("#cboShipMethod@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "ShipMethod" }, "", "NA", "", "ShipMethodName", "ShipMethodNo");    //運輸方式
            ComboBoxs.Default("#cboShipType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Ship" }, "", "NA", "", "TypeName", "TypeNo");    //運輸種類
            ComboBoxs.Default("#cboForwarderId@(itemName)", "@Url.Action("GetForwarder", "ScmBasicInformation")", {}, "", "NA", "", "ForwarderName", "ForwarderId");    //貨運承攬商
            ComboBoxs.Default("#cboCreditLimitControl@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.CreditLimitControl" }, "", "NA", "", "TypeName", "TypeNo");    //信用額度管制
            ComboBoxs.Default("#cboCreditLimitControlCurrency@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.CreditLimitCurrency" }, "", "NA", "", "TypeName", "TypeNo");    //信用額度控管幣別
            ComboBoxs.Default("#cboSoCreditAuditType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.CreditAudit" }, "", "NA", "", "TypeName", "TypeNo");    //訂單信用查核方式
            ComboBoxs.Default("#cboSSiCreditAuditType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.CreditAudit" }, "", "NA", "", "TypeName", "TypeNo");    //銷貨信用查核方式
            ComboBoxs.Default("#cboDoCreditAuditType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.CreditAudit" }, "", "NA", "", "TypeName", "TypeNo");    //出貨通知信用查核方式
            ComboBoxs.Default("#cboInTransitCreditAuditType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.CreditAudit" }, "", "NA", "", "TypeName", "TypeNo");    //暫出單信用查核方式       

            Suites.DateDropper("#txtPermitDate@(itemName), #txtInauguateDate@(itemName), #txtCloseDate@(itemName)");

            Suites.SetDateDropper("#txtPermitDate@(itemName), #txtInauguateDate@(itemName), #txtCloseDate@(itemName)");

            $("#cboTaxNo@(itemName)").off("change").on("change", function () {
                ComboBoxs.Default("#cboInvoiceCount@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "InvoiceCount", "Condition": $("#cboTaxNo@(itemName)").val() }, "", "CHOOSE", "", "InvoiceCountName", "InvoiceCountNo");

                let taxation;
                let targetUrl = "@Url.Action("GetErpData", "BasicInformation")";
                let postData = {
                    "ColumnName": "TaxNo",
                    "Condition": $("#cboTaxNo@(itemName)").val()
                };

                let data = DataAccess.Get(targetUrl, postData, false);

                if (data.status == "success") {
                    $.each(data.result, function (i, item) {
                        taxation = item.Taxation;
                    });
                }

                ComboBoxs.Default("#cboTaxation@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Taxation" }, taxation, "NA", "", "TypeName", "TypeNo");
            });

            if (CustomerId > 0) {
                $("#txtCustomerNo@(itemName)").attr("readonly", true);

                let targetUrl = "@Url.Action("GetCustomer", "ScmBasicInformation")";
                let postData = {
                    "CustomerId": CustomerId
                };

                let data = DataAccess.Get(targetUrl, postData, false);

                if (data.status == "success") {
                    $.each(data.result, function (i, item) {
                        $("#txtCustomerNo@(itemName)").val(item.CustomerNo);
                        $("#txtCustomerName@(itemName)").val(item.CustomerName);
                        $("#txtCustomerEnglishName@(itemName)").val(item.CustomerEnglishName);
                        $("#txtCustomerShortName@(itemName)").val(item.CustomerShortName);
                        $("#cboRelatedPerson@(itemName)").val(item.RelatedPerson);
                        if (item.PermitDate) {
                            Suites.SetDateDropper("#txtPermitDate@(itemName)", new Date(item.PermitDate));
                        }
                        $("#txtVersion@(itemName)").val(item.Version);
                        $("#txtResponsiblePerson@(itemName)").val(item.ResponsiblePerson);
                        $("#txtContact@(itemName)").val(item.Contact);
                        $("#txtTelNoFirst@(itemName)").val(item.TelNoFirst);
                        $("#txtTelNoSecond@(itemName)").val(item.TelNoSecond);
                        $("#txtFaxNo@(itemName)").val(item.FaxNo);
                        $("#txtEmail@(itemName)").val(item.Email);
                        $("#txtGuiNumber@(itemName)").val(item.GuiNumber);
                        $("#txtCapital@(itemName)").val(item.Capital);
                        $("#txtAnnualTurnover@(itemName)").val(item.AnnualTurnover);
                        $("#txtHeadcount@(itemName)").val(item.Headcount);
                        $("#txtHomeOffice@(itemName)").val(item.HomeOffice);
                        $("#cboCurrency@(itemName)").val(item.Currency);
                        $("#cboDepartmentId@(itemName)").val(item.DepartmentId);
                        $("#cboCustomerKind@(itemName)").val(item.CustomerKind);
                        $("#cboSalesmenId@(itemName)").val(item.SalesmenId);
                        $("#cboPaymentSalesmenId@(itemName)").val(item.PaymentSalesmenId);
                        if (item.InauguateDate) {
                            Suites.SetDateDropper("#txtInauguateDate@(itemName)", new Date(item.InauguateDate));
                        }
                        if (item.CloseDate) {
                            Suites.SetDateDropper("#txtCloseDate@(itemName)", new Date(item.CloseDate));
                        }               
                        $("#txtZipCodeRegister@(itemName)").val(item.ZipCodeRegister);
                        $("#txtRegisterAddressFirst@(itemName)").val(item.RegisterAddressFirst);
                        $("#txtRegisterAddressSecond@(itemName)").val(item.RegisterAddressSecond);
                        $("#txtZipCodeInvoice@(itemName)").val(item.ZipCodeInvoice);
                        $("#txtInvoiceAddressFirst@(itemName)").val(item.InvoiceAddressFirst);
                        $("#txtInvoiceAddressSecond@(itemName)").val(item.InvoiceAddressSecond);
                        $("#txtZipCodeDelivery@(itemName)").val(item.ZipCodeDelivery);
                        $("#txtDeliveryAddressFirst@(itemName)").val(item.DeliveryAddressFirst);
                        $("#txtDeliveryAddressSecond@(itemName)").val(item.DeliveryAddressSecond);
                        $("#txtZipCodeDocument@(itemName)").val(item.ZipCodeDocument);
                        $("#txtDocumentAddressFirst@(itemName)").val(item.DocumentAddressFirst);
                        $("#txtDocumentAddressSecond@(itemName)").val(item.DocumentAddressSecond);
                        $("#txtBillReceipient@(itemName)").val(item.BillReceipient);
                        $("#txtZipCodeBill@(itemName)").val(item.ZipCodeBill);
                        $("#txtBillAddressFirst@(itemName)").val(item.BillAddressFirst);
                        $("#txtBillAddressSecond@(itemName)").val(item.BillAddressSecond);
                        if (item.InvocieAttachedStatus == "Y") $("#chkInvocieAttachedStatus@(itemName)Y").prop("checked", true);
                        if (item.InvocieAttachedStatus == "N") $("#chkInvocieAttachedStatus@(itemName)N").prop("checked", true);
                        $("#txtDepositRate@(itemName)").val(item.DepositRate);
                        $("#cboTaxAmountCalculateType@(itemName)").val(item.TaxAmountCalculateType);
                        $("#cboSaleRating@(itemName)").val(item.SaleRating);
                        $("#cboCreditRating@(itemName)").val(item.CreditRating);
                        $("#cboTradeTerm@(itemName)").val(item.TradeTerm);
                        $("#cboPaymentTerm@(itemName)").val(item.PaymentTerm);
                        $("#cboPricingType@(itemName)").val(item.PricingType);
                        $("#cboClearanceType@(itemName)").val(item.ClearanceType);
                        $("#cboDocumentDeliver@(itemName)").val(item.DocumentDeliver);
                        $("#cboReceiptReceive@(itemName)").val(item.ReceiptReceive);
                        $("#cboPaymentType@(itemName)").val(item.PaymentType);
                        $("#cboTaxNo@(itemName)").val(item.TaxNo).trigger("change");
                        $("#cboCountry@(itemName)").val(item.Country);
                        $("#cboRegion@(itemName)").val(item.Region);
                        $("#cboRoute@(itemName)").val(item.Route);
                        $("#cboUploadType@(itemName)").val(item.UploadType);
                        $("#cboPaymentBankFirst@(itemName)").val(item.PaymentBankFirst);
                        $("#txtBankAccountFirst@(itemName)").val(item.BankAccountFirst);

                        $("#cboPaymentBankSecond@(itemName)").val(item.PaymentBankSecond);
                        $("#txtBankAccountSecond@(itemName)").val(item.BankAccountSecond);

                        if (item.PaymentBankSecond || item.BankAccountSecond) {
                            let element = $(".bank-account");

                            $(element[1]).show();
                            displayBank[1] = 1;
                        }

                        $("#cboPaymentBankThird@(itemName)").val(item.PaymentBankThird);
                        $("#txtBankAccountThird@(itemName)").val(item.BankAccountThird);

                        if (item.PaymentBankThird || item.PaymentBankThird) {
                            let element = $(".bank-account");

                            $(element[2]).show();
                            displayBank[2] = 1;
                        }

                        $("#cboAccount@(itemName)").val(item.Account);
                        $("#cboAccountInvoice@(itemName)").val(item.AccountInvoice);
                        $("#txtAccountDay@(itemName)").val(item.AccountDay);
                        $("#cboShipMethod@(itemName)").val(item.ShipMethod);
                        $("#cboShipType@(itemName)").val(item.ShipType);
                        $("#cboForwarderId@(itemName)").val(item.ForwarderId);
                        $("#txtCustomerRemark@(itemName)").val(item.CustomerRemark);
                        $("#txtCreditLimit@(itemName)").val(item.CreditLimit);
                        $("#cboCreditLimitControl@(itemName)").val(item.CreditLimitControl);
                        $("#cboCreditLimitControlCurrency@(itemName)").val(item.CreditLimitControlCurrency);
                        $("#cboSoCreditAuditType@(itemName)").val(item.SoCreditAuditType);
                        $("#cboSSiCreditAuditType@(itemName)").val(item.SiCreditAuditType);
                        $("#cboDoCreditAuditType@(itemName)").val(item.DoCreditAuditType);
                        $("#cboInTransitCreditAuditType@(itemName)").val(item.InTransitCreditAuditType);
                    });
                } else {
                    alert(data.msg, "alert", 0);
                }
            }
            
            if (!isMobile) {
                $("#cboRelatedPerson@(itemName), #cboCurrency@(itemName), #cboDepartmentId@(itemName), #cboCustomerKind@(itemName), #cboSalesmenId@(itemName), #cboPaymentSalesmenId@(itemName)").select2({
                    dropdownAutoWidth: true,
                    width: "100%"
                });

                $("#cboTaxAmountCalculateType@(itemName), #cboSaleRating@(itemName), #cboCreditRating@(itemName), #cboTradeTerm@(itemName), #cboPaymentTerm@(itemName), #cboPricingType@(itemName), #cboClearanceType@(itemName), #cboDocumentDeliver@(itemName), #cboReceiptReceive@(itemName), #cboPaymentType@(itemName), #cboTaxNo@(itemName), #cboInvoiceCount@(itemName), #cboTaxation@(itemName)").select2({
                    dropdownAutoWidth: true,
                    width: "100%"
                });

                $("#cboCountry@(itemName), #cboRegion@(itemName), #cboRoute@(itemName), #cboUploadType@(itemName), #cboPaymentBankFirst@(itemName), #cboPaymentBankSecond@(itemName), #cboPaymentBankThird@(itemName), #cboAccount@(itemName), #cboAccountInvoice@(itemName), #cboShipMethod@(itemName), #cboShipType@(itemName), #cboForwarderId@(itemName)").select2({
                    dropdownAutoWidth: true,
                    width: "100%"
                });

                $("#cboCreditLimitControl@(itemName), #cboCreditLimitControlCurrency@(itemName), #cboSoCreditAuditType@(itemName), #cboSSiCreditAuditType@(itemName), #cboDoCreditAuditType@(itemName), #cboInTransitCreditAuditType@(itemName)").select2({
                    dropdownAutoWidth: true,
                    width: "100%"
                });
            }
        }

        function Read@(itemName)(CustomerId) {
            Edit@(itemName)(CustomerId);
            $(objForm@(itemName) + " fieldset").attr("disabled", true);
            $(objForm@(itemName) + " select").attr("disabled", true);
            $(".BankAccount").hide();
            $(".btn-outline-danger").hide();
        }

        function Save@(itemName)() {
            if ($(objForm@(itemName)).valid()) {

                let CustomerId = parseInt($("#CustomerId").val());

                if (CustomerId <= 0) {
                    let targetUrl = "@Url.Action("AddCustomer", "ScmBasicInformation")";
                    let postData = {
                        "CustomerNo": $("#txtCustomerNo@(itemName)").val(),
                        "CustomerName": $("#txtCustomerName@(itemName)").val(),
                        "CustomerEnglishName": $("#txtCustomerEnglishName@(itemName)").val(),
                        "CustomerShortName": $("#txtCustomerShortName@(itemName)").val(),
                        "RelatedPerson": $("#cboRelatedPerson@(itemName)").val(),
                        "PermitDate": $("#txtPermitDate@(itemName)").val(),
                        "ResponsiblePerson": $("#txtResponsiblePerson@(itemName)").val(),
                        "Contact": $("#txtContact@(itemName)").val(),
                        "TelNoFirst": $("#txtTelNoFirst@(itemName)").val(),
                        "TelNoSecond": $("#txtTelNoSecond@(itemName)").val(),
                        "FaxNo": $("#txtFaxNo@(itemName)").val(),
                        "Email": $("#txtEmail@(itemName)").val(),
                        "GuiNumber": $("#txtGuiNumber@(itemName)").val(),
                        "Capital": $("#txtCapital@(itemName)").val(),
                        "AnnualTurnover": $("#txtAnnualTurnover@(itemName)").val(),
                        "Headcount": $("#txtHeadcount@(itemName)").val(),
                        "HomeOffice": $("#txtHomeOffice@(itemName)").val(),
                        "Currency": $("#cboCurrency@(itemName)").val(),
                        "DepartmentId": $("#cboDepartmentId@(itemName)").val(),
                        "CustomerKind": $("#cboCustomerKind@(itemName)").val(),
                        "SalesmenId": $("#cboSalesmenId@(itemName)").val(),
                        "PaymentSalesmenId": $("#cboPaymentSalesmenId@(itemName)").val(),
                        "InauguateDate": $("#txtInauguateDate@(itemName)").val(),
                        "CloseDate": $("#txtCloseDate@(itemName)").val(),
                        "ZipCodeRegister": $("#txtZipCodeRegister@(itemName)").val(),
                        "RegisterAddressFirst": $("#txtRegisterAddressFirst@(itemName)").val(),
                        "RegisterAddressSecond": $("#txtRegisterAddressSecond@(itemName)").val(),
                        "ZipCodeInvoice": $("#txtZipCodeInvoice@(itemName)").val(),
                        "InvoiceAddressFirst": $("#txtInvoiceAddressFirst@(itemName)").val(),
                        "InvoiceAddressSecond": $("#txtInvoiceAddressSecond@(itemName)").val(),
                        "ZipCodeDelivery": $("#txtZipCodeDelivery@(itemName)").val(),
                        "DeliveryAddressFirst": $("#txtDeliveryAddressFirst@(itemName)").val(),
                        "DeliveryAddressSecond": $("#txtDeliveryAddressSecond@(itemName)").val(),
                        "ZipCodeDocument": $("#txtZipCodeDocument@(itemName)").val(),
                        "DocumentAddressFirst": $("#txtDocumentAddressFirst@(itemName)").val(),
                        "DocumentAddressSecond": $("#txtDocumentAddressSecond@(itemName)").val(),
                        "BillReceipient": $("#txtBillReceipient@(itemName)").val(),
                        "ZipCodeBill": $("#txtZipCodeBill@(itemName)").val(),
                        "BillAddressFirst": $("#txtBillAddressFirst@(itemName)").val(),
                        "BillAddressSecond": $("#txtBillAddressSecond@(itemName)").val(),
                        "InvocieAttachedStatus": $("input[name='chkInvocieAttachedStatus@(itemName)']:checked").val(),
                        "DepositRate": $("#txtDepositRate@(itemName)").val(),
                        "TaxAmountCalculateType": $("#cboTaxAmountCalculateType@(itemName)").val(),
                        "SaleRating": $("#cboSaleRating@(itemName)").val(),
                        "CreditRating": $("#cboCreditRating@(itemName)").val(),
                        "TradeTerm": $("#cboTradeTerm@(itemName)").val(),
                        "PaymentTerm": $("#cboPaymentTerm@(itemName)").val(),
                        "PricingType": $("#cboPricingType@(itemName)").val(),
                        "ClearanceType": $("#cboClearanceType@(itemName)").val(),
                        "DocumentDeliver": $("#cboDocumentDeliver@(itemName)").val(),
                        "ReceiptReceive": $("#cboReceiptReceive@(itemName)").val(),
                        "PaymentType": $("#cboPaymentType@(itemName)").val(),
                        "TaxNo": $("#cboTaxNo@(itemName)").val(),
                        "InvoiceCount": $("#cboInvoiceCount@(itemName)").val(),
                        "Taxation": $("#cboTaxation@(itemName)").val(),
                        "Country": $("#cboCountry@(itemName)").val(),
                        "Region": $("#cboRegion@(itemName)").val(),
                        "Route": $("#cboRoute@(itemName)").val(),
                        "UploadType": $("#cboUploadType@(itemName)").val(),
                        "PaymentBankFirst": $("#cboPaymentBankFirst@(itemName)").val(),
                        "BankAccountFirst": $("#txtBankAccountFirst@(itemName)").val(),
                        "PaymentBankSecond": $("#cboPaymentBankSecond@(itemName)").val(),
                        "BankAccountSecond": $("#txtBankAccountSecond@(itemName)").val(),
                        "PaymentBankThird": $("#cboPaymentBankThird@(itemName)").val(),
                        "BankAccountThird": $("#txtBankAccountThird@(itemName)").val(),
                        "Account": $("#cboAccount@(itemName)").val(),
                        "AccountInvoice": $("#cboAccountInvoice@(itemName)").val(),
                        "AccountDay": $("#txtAccountDay@(itemName)").val(),
                        "ShipMethod": $("#cboShipMethod@(itemName)").val(),
                        "ShipType": $("#cboShipType@(itemName)").val(),
                        "ForwarderId": $("#cboForwarderId@(itemName)").val(),
                        "CustomerRemark": $("#txtCustomerRemark@(itemName)").val(),
                        "CreditLimit": $("#txtCreditLimit@(itemName)").val(),
                        "CreditLimitControl": $("#cboCreditLimitControl@(itemName)").val(),
                        "CreditLimitControlCurrency": $("#cboCreditLimitControlCurrency@(itemName)").val(),
                        "SoCreditAuditType": $("#cboSoCreditAuditType@(itemName)").val(),
                        "SiCreditAuditType": $("#cboSSiCreditAuditType@(itemName)").val(),
                        "DoCreditAuditType": $("#cboDoCreditAuditType@(itemName)").val(),
                        "InTransitCreditAuditType": $("#cboInTransitCreditAuditType@(itemName)").val()
                    };

                    let result = DataAccess.Add(targetUrl, postData, false, true);

                    if (result) {
                        Return@(itemName)();
                    }
                } else {
                    let targetUrl = "@Url.Action("UpdateCustomer", "ScmBasicInformation")";
                    let postData = {
                        "CustomerId": CustomerId,
                        "CustomerNo": $("#txtCustomerNo@(itemName)").val(),
                        "CustomerName": $("#txtCustomerName@(itemName)").val(),
                        "CustomerEnglishName": $("#txtCustomerEnglishName@(itemName)").val(),
                        "CustomerShortName": $("#txtCustomerShortName@(itemName)").val(),
                        "RelatedPerson": $("#cboRelatedPerson@(itemName)").val(),
                        "PermitDate": $("#txtPermitDate@(itemName)").val(),
                        "Version": (parseInt($("#txtVersion@(itemName)").val(), 10) + 1).toString().padStart(4, '0'),
                        "ResponsiblePerson": $("#txtResponsiblePerson@(itemName)").val(),
                        "Contact": $("#txtContact@(itemName)").val(),
                        "TelNoFirst": $("#txtTelNoFirst@(itemName)").val(),
                        "TelNoSecond": $("#txtTelNoSecond@(itemName)").val(),
                        "FaxNo": $("#txtFaxNo@(itemName)").val(),
                        "Email": $("#txtEmail@(itemName)").val(),
                        "GuiNumber": $("#txtGuiNumber@(itemName)").val(),
                        "Capital": $("#txtCapital@(itemName)").val(),
                        "AnnualTurnover": $("#txtAnnualTurnover@(itemName)").val(),
                        "Headcount": $("#txtHeadcount@(itemName)").val(),
                        "HomeOffice": $("#txtHomeOffice@(itemName)").val(),
                        "Currency": $("#cboCurrency@(itemName)").val(),
                        "DepartmentId": $("#cboDepartmentId@(itemName)").val(),
                        "CustomerKind": $("#cboCustomerKind@(itemName)").val(),
                        "SalesmenId": $("#cboSalesmenId@(itemName)").val(),
                        "PaymentSalesmenId": $("#cboPaymentSalesmenId@(itemName)").val(),
                        "InauguateDate": $("#txtInauguateDate@(itemName)").val(),
                        "CloseDate": $("#txtCloseDate@(itemName)").val(),
                        "ZipCodeRegister": $("#txtZipCodeRegister@(itemName)").val(),
                        "RegisterAddressFirst": $("#txtRegisterAddressFirst@(itemName)").val(),
                        "RegisterAddressSecond": $("#txtRegisterAddressSecond@(itemName)").val(),
                        "ZipCodeInvoice": $("#txtZipCodeInvoice@(itemName)").val(),
                        "InvoiceAddressFirst": $("#txtInvoiceAddressFirst@(itemName)").val(),
                        "InvoiceAddressSecond": $("#txtInvoiceAddressSecond@(itemName)").val(),
                        "ZipCodeDelivery": $("#txtZipCodeDelivery@(itemName)").val(),
                        "DeliveryAddressFirst": $("#txtDeliveryAddressFirst@(itemName)").val(),
                        "DeliveryAddressSecond": $("#txtDeliveryAddressSecond@(itemName)").val(),
                        "ZipCodeDocument": $("#txtZipCodeDocument@(itemName)").val(),
                        "DocumentAddressFirst": $("#txtDocumentAddressFirst@(itemName)").val(),
                        "DocumentAddressSecond": $("#txtDocumentAddressSecond@(itemName)").val(),
                        "BillReceipient": $("#txtBillReceipient@(itemName)").val(),
                        "ZipCodeBill": $("#txtZipCodeBill@(itemName)").val(),
                        "BillAddressFirst": $("#txtBillAddressFirst@(itemName)").val(),
                        "BillAddressSecond": $("#txtBillAddressSecond@(itemName)").val(),
                        "InvocieAttachedStatus": $("input[name='chkInvocieAttachedStatus@(itemName)']:checked").val(),
                        "DepositRate": $("#txtDepositRate@(itemName)").val(),
                        "TaxAmountCalculateType": $("#cboTaxAmountCalculateType@(itemName)").val(),
                        "SaleRating": $("#cboSaleRating@(itemName)").val(),
                        "CreditRating": $("#cboCreditRating@(itemName)").val(),
                        "TradeTerm": $("#cboTradeTerm@(itemName)").val(),
                        "PaymentTerm": $("#cboPaymentTerm@(itemName)").val(),
                        "PricingType": $("#cboPricingType@(itemName)").val(),
                        "ClearanceType": $("#cboClearanceType@(itemName)").val(),
                        "DocumentDeliver": $("#cboDocumentDeliver@(itemName)").val(),
                        "ReceiptReceive": $("#cboReceiptReceive@(itemName)").val(),
                        "PaymentType": $("#cboPaymentType@(itemName)").val(),
                        "TaxNo": $("#cboTaxNo@(itemName)").val(),
                        "InvoiceCount": $("#cboInvoiceCount@(itemName)").val(),
                        "Taxation": $("#cboTaxation@(itemName)").val(),
                        "Country": $("#cboCountry@(itemName)").val(),
                        "Region": $("#cboRegion@(itemName)").val(),
                        "Route": $("#cboRoute@(itemName)").val(),
                        "UploadType": $("#cboUploadType@(itemName)").val(),
                        "PaymentBankFirst": $("#cboPaymentBankFirst@(itemName)").val(),
                        "BankAccountFirst": $("#txtBankAccountFirst@(itemName)").val(),
                        "PaymentBankSecond": $("#cboPaymentBankSecond@(itemName)").val(),
                        "BankAccountSecond": $("#txtBankAccountSecond@(itemName)").val(),
                        "PaymentBankThird": $("#cboPaymentBankThird@(itemName)").val(),
                        "BankAccountThird": $("#txtBankAccountThird@(itemName)").val(),
                        "Account": $("#cboAccount@(itemName)").val(),
                        "AccountInvoice": $("#cboAccountInvoice@(itemName)").val(),
                        "AccountDay": $("#txtAccountDay@(itemName)").val(),
                        "ShipMethod": $("#cboShipMethod@(itemName)").val(),
                        "ShipType": $("#cboShipType@(itemName)").val(),
                        "ForwarderId": $("#cboForwarderId@(itemName)").val(),
                        "CustomerRemark": $("#txtCustomerRemark@(itemName)").val(),
                        "CreditLimit": $("#txtCreditLimit@(itemName)").val(),
                        "CreditLimitControl": $("#cboCreditLimitControl@(itemName)").val(),
                        "CreditLimitControlCurrency": $("#cboCreditLimitControlCurrency@(itemName)").val(),
                        "SoCreditAuditType": $("#cboSoCreditAuditType@(itemName)").val(),
                        "SiCreditAuditType": $("#cboSSiCreditAuditType@(itemName)").val(),
                        "DoCreditAuditType": $("#cboDoCreditAuditType@(itemName)").val(),
                        "InTransitCreditAuditType": $("#cboInTransitCreditAuditType@(itemName)").val()
                    };

                    let result = DataAccess.Update(targetUrl, postData, false, true);

                    if (result) {
                        Return@(itemName)();
                    }
                }
            }
        }

        function Return@(itemName)() {
            ResetForm(objForm@(itemName));
            Switch("#listData@(itemName)", "#editData@(itemName), .unit-block");
            Query@(itemName)();
        }

        function StatusSwitch@(itemName)() {
            var CustomerId = $(this).data("customer-id");

            let targetUrl = "@Url.Action("UpdateCustomerStatus", "ScmBasicInformation")";
            let postData = {
                "CustomerId": CustomerId
            };

            let result = DataAccess.Update(targetUrl, postData, false, true);

            if (result) {
                Return@(itemName)();
                Query@(itemName)();
            }
        }

        function AddBank@(itemName)() {
            let element = $(".bank-account");
            
            for (var i = 0; i < displayBank.length; i++) {
                if (displayBank[i] == 0) {
                    $(element[i]).show();
                    displayBank[i] = 1;
                    break;
                }
            }
        }

        function DeleteBank@(itemName)(index) {
            let element = $(".bank-account");

            $(element[index]).find("input[type=text]").val("");
            $(element[index]).find("select").val("");
            $("#cboPaymentBankFirst@(itemName), #cboPaymentBankSecond@(itemName), #cboPaymentBankThird@(itemName)").select2({
                width: "100%"
            });

            $(element[index]).hide();
            displayBank[index] = 0;
        }

        function Next@(itemName)() {
            if ($(objForm@(itemName)).valid()) {
                $(".nav-item > .active").parent().next("li").find("a").trigger("click");
            }
        }
        function Prev@(itemName)() {
            $(".nav-item > .active").parent().prev("li").find("a").trigger("click");
        }
    </script>
)
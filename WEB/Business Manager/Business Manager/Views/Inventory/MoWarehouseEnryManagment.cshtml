@using Business_Manager.Helpers
@{
    string itemName = "MoWarehouseEnryManagment";
    string itemNameText = "入庫管理";
    string authority = ViewBag.authority;
    int UserId = Convert.ToInt32(Session["UserId"]);
    string RequestMweFullErpNo = Request["MweFullErpNo"] ?? "";

    ViewBag.Title = itemNameText;
}

@Html.Resource("css",
    @<style>
         .thead-customized {
             min-width: 75px !important;
             background-color: #ffeeba !important;
             position: relative !important;
             z-index: 1 !important;
             border: none !important;
         }

         .tbody-customized {
             border: none !important;
         }

        .table-sticky thead .col-sticky:nth-last-child(1) {
            right: 0;
        }

        .table-sticky tbody .col-sticky:nth-last-child(1) {
            right: 0;
        }
        .table-sticky thead .col-sticky:nth-child(1) {
            left: 0;
        }

        .table-sticky tbody .col-sticky:nth-child(1) {
            left: 0;
        }

        .table-sticky thead .col-sticky:nth-child(2) {
            left: 50px;
        }

        .table-sticky tbody .col-sticky:nth-child(2) {
            left: 50px;
        }
    </style>
                        )
<input type="hidden" id="pageAuthority" value="@authority" />
<input type="hidden" id="TransferStatus" value="" />
<input type="hidden" id="MoneyDataShow" value="" />

<div class="row">
    <div class="col-12 title-block">
        <h1 class="pt-2 pb-3">@(itemNameText)</h1>
        <div class="unit-block">
            <div class="button-block mb-1">
                <button type="button" class="btn btn-secondary" onclick="Return@(itemName)()"><i class="fas fa-undo"></i>返回</button>
            </div>
        </div>
    </div>
</div>

<!--搜尋-->
<div class="modal fade" id="modalQuery@(itemName)">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">搜尋</h5>
                <button class="close" data-dismiss="modal" type="button">
                    <span aria-hidden="true"><i class="fas fa-times"></i></span>
                </button>
            </div>
            <div class="modal-body">
                <form class="container" autocomplete="off" id="queryForm@(itemName)">
                    <fieldset>
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="cboMweErpPrefixQ@(itemName)">入庫單單別</label>
                            <div class="col-12">
                                <select class="form-control" id="cboMweErpPrefixQ@(itemName)" name="cboMweErpPrefixQ@(itemName)">
                                    <option value="">-- 請選擇入庫單單別 --</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="txtMweErpFullNoQ@(itemName)">入庫單編號</label>
                            <div class="col-12">
                                <input type="text" class="form-control" id="txtMweErpFullNoQ@(itemName)" name="txtMweErpFullNoQ@(itemName)" placeholder="請輸入入庫單編號" />
                            </div>
                        </div>
                        @*<div class="form-group row">
                                <label class="col-12 col-form-label" for="txtMweCreateByQ@(itemName)">建單者</label>
                                <div class="col-12">
                                    <input type="text" class="form-control" id="txtMweCreateByQ@(itemName)" name="txtMweCreateByQ@(itemName)" placeholder="請輸入建單者" />
                                </div>
                            </div>*@
                        <div class="form-group row">
                            <label class="col-12 col-form-label">單據日期 <input type="checkbox" id="cbxDocDateQ@(itemName)" checked/></label>
                            <div class="col-6">
                                <input type="text" class="form-control" id="txtStartDocDateQ@(itemName)" name="txtStartDocDateQ@(itemName)"
                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                       readonly />
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control" id="txtEndDocDateQ@(itemName)" name="txtEndDocDateQ@(itemName)"
                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                       readonly />
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 col-form-label">進貨日期 <input type="checkbox" id="cbxReceiptDateQ@(itemName)" /></label>
                            <div class="col-6">
                                <input type="text" class="form-control" id="txtStartReceiptDateQ@(itemName)" name="txtStartReceiptDateQ@(itemName)"
                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                       readonly />
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control" id="txtEndReceiptDateQ@(itemName)" name="txtEndReceiptDateQ@(itemName)"
                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                       readonly />
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="cbConfirmStatusQ@(itemName)">確認碼</label>
                            <div class="col-12">
                                <select class="form-control" id="cbConfirmStatusQ@(itemName)" name="cbConfirmStatusQ@(itemName)">
                                    <option value="">-- 請選擇確認碼 --</option>
                                </select>
                            </div>
                        </div>
                        @*<div class="form-group row">
                                <label class="col-12 col-form-label" for="cboTransferStatusQ@(itemName)">ERP拋轉狀態碼</label>
                                <div class="col-12">
                                    <select class="form-control" id="cboTransferStatusQ@(itemName)" name="cboTransferStatusQ@(itemName)">
                                        <option value="">-- 請選擇ERP拋轉狀態碼 --</option>
                                    </select>
                                </div>
                            </div>*@

                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="cboWoErpPrefixQ@(itemName)">工單單別</label>
                            <div class="col-12">
                                <select class="form-control" id="cboWoErpPrefixQ@(itemName)" name="cboWoErpPrefixQ@(itemName)">
                                    <option value="">-- 請選擇工單單別 --</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="txtWoErpFullNoQ@(itemName)">工單編號</label>
                            <div class="col-12">
                                <input type="text" class="form-control" id="txtWoErpFullNoQ@(itemName)" name="txtWoErpFullNoQ@(itemName)" placeholder="請輸入工單編號" />
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="txtMtlItemNoQ@(itemName)">產品品號</label>
                            <div class="col-12">
                                <input type="text" class="form-control" id="txtMtlItemNoQ@(itemName)" name="txtMtlItemNoQ@(itemName)" placeholder="請輸入材料品號" />
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="cboInventoryIdQ@(itemName)">進貨庫別</label>
                            <div class="col-12">
                                <select class="form-control" id="cboInventoryIdQ@(itemName)" name="cboInventoryIdQ@(itemName)">
                                    <option value="">-- 請選擇進貨庫別 --</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="Query@(itemName)()" style="margin: auto;"><i class="fal fa-wrench"></i>套用</button>
            </div>
        </div>
    </div>
</div>
<!--列表-->
<div class="row" id="listData@(itemName)">
    <div class="col-12">
        <div class="card card-shadow mb-4">
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-6 col-sm-6 col-md-6">
                        <a class="btn btn-primary" data-backdrop="static" data-keyboard="false" data-toggle="modal" data-target="#modalQuery@(itemName)" href="javascript:void(0);"><i class="fal fa-search"></i>搜尋</a>
                    </div>
                    <div class="col-6 col-sm-6 col-md-6 text-right">
                        <a class="btn btn-info auth-add" href="javascript:Edit@(itemName)();"><i class="fas fa-plus"></i>新增</a>
                        <a class="btn btn-primary" data-backdrop="static" data-keyboard="false" data-toggle="modal"  data-target="#modalQueryProjectOutCycle@(itemName)"  href="javascript:void(0);" onclick="QueryProjectOutCycle@(itemName)()">
                            <i class="fal fa-print"></i>托外進貨週期性報表匯出
                        </a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="table-custom">
                            <table class="table table-bordered table-striped table-sticky" id="tblData@(itemName)">
                                <thead>
                                    <tr>
                                        <th class="col-sticky" scope="col" style="min-width: 50px;">#</th>
                                        <th class="text-center" scope="col" style="min-width: 75px;">操作</th>
                                        <th class="col-sticky" scope="col" style="min-width: 200px;">入庫單編號</th>
                                        <th scope="col" style="min-width: 150px;">單據日期</th>
                                        <th scope="col" style="min-width: 150px;">進貨日期</th>
                                        <th class="text-center" scope="col" style="min-width: 150px;">確認碼</th>
                                        <th class="text-center" scope="col" style="min-width: 150px;">ERP拋轉狀態</th>
                                        <th class="text-center" scope="col" style="min-width: 150px;">建單者</th>
                                        <th class="text-center" scope="col" style="min-width: 150px;">確認者</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <div class="pagination" id="page@(itemName)"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--新增/編輯-->
<div class="row" id="editData@(itemName)" style="display: none;">
    <div class="col-12">
        <div class="card card-shadow mb-4">
            <div class="card-body">
                <form class="container custom-form-container" autocomplete="off" id="editForm@(itemName)">
                    <fieldset>
                        <input type="hidden" id="MweId" name="MweId" value="-1" />
                        <input type="hidden" id="ConfirmStatus" name="ConfirmStatus" value="-1" />
                        <div class="row">
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtDocDate@(itemName)">開單日期<span class="text-danger">*</span></label>
                                    <div class="col-12 col-md-9 col-lg-9">
                                        <input type="text" class="form-control" id="txtDocDate@(itemName)" name="txtDocDate@(itemName)"
                                               data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"   data-rule-required="true"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtReceiptDate@(itemName)">進貨日期<span class="text-danger">*</span></label>
                                    <div class="col-12 col-md-9 col-lg-9">
                                        <input type="text" class="form-control" id="txtReceiptDate@(itemName)" name="txtReceiptDate@(itemName)"
                                               data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"   data-rule-required="true"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboMweErpPrefix@(itemName)">入庫單別<span class="text-danger">*</span></label>
                                    <div class="col-12 col-md-9 col-lg-9">
                                        <select class="form-control" id="cboMweErpPrefix@(itemName)" name="cboMweErpPrefix@(itemName)"   data-rule-required="true">
                                            <option value="">-- 請選擇入庫單別 --</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtMweErpNo@(itemName)">入庫單號</label>
                                    <div class="col-12 col-md-9 col-lg-9">
                                        <input type="text" class="form-control" id="txtMweErpNo@(itemName)" name="txtMweErpNo@(itemName)" placeholder="入庫單號" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row showSupplier">
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboSupplierId@(itemName)">加工廠商<span class="text-danger">*</span></label>
                                    <div class="col-12 col-md-9 col-lg-9">
                                        <select class="form-control" id="cboSupplierId@(itemName)" name="cboSupplierId@(itemName)" data-rule-required="true">
                                            <option value="">-- 請選擇加工廠商 --</option>
                                        </select>
                                    </div>
                                    <input type="hidden" id="SupplierNo" value="" />
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-12">
                                <div class="form-group row">
                                    <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtRemark@(itemName)">備註</label>
                                    <div class="col-12 col-md-9 col-lg-9">
                                        <textarea class="form-control" id="txtRemark@(itemName)" name="txtRemark@(itemName)"
                                                  data-msg-maxlength="必須少於 255 個字元" maxlength="255" rows="2" placeholder="請輸入備註"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab" style="white-space:unset;">
                            <ul class="nav nav-tabs nav-fill mb-3" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="tabActive" data-toggle="tab" href="#tabInvoice">
                                        <i class="far fa-file-invoice-dollar"></i> 發票資料
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#tabOther">
                                        <i class="fas fa-folder"></i> 其他資料
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#tabMoney">
                                        <i class="fas fa-folder"></i> 金額資料
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabInvoice">
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboTaxCode@(itemName)">稅別碼<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <select class="form-control" id="cboTaxCode@(itemName)" name="cboTaxCode@(itemName)" data-rule-required="true" disabled></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboTaxType@(itemName)">課稅別<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <select class="form-control" id="cboTaxType@(itemName)" name="cboTaxType@(itemName)" disabled></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtTaxRate@(itemName)">營業稅率<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" step="any" min="0" max="99999" class="form-control" id="txtTaxRate@(itemName)" name="txtTaxRate@(itemName)"
                                                        value="0.00"
                                                        placeholder="請輸入營業稅率"
                                                        data-msg-required="請輸入營業稅率" data-rule-required="true" readonly />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtApplyYYMM@(itemName)">申報年月<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="text" class="form-control" id="txtApplyYYMM@(itemName)" name="txtApplyYYMM@(itemName)"
                                                        placeholder="請輸入申報年月"
                                                        data-msg-required="請輸入申報年月" data-rule-required="true"
                                                        data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2]))" readonly />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboDeductType@(itemName)">扣抵區分<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <select class="form-control" id="cboDeductType@(itemName)" name="cboDeductType@(itemName)" data-rule-required="true"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtUiNo@(itemName)">統一編號</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="text" class="form-control" id="txtUiNo@(itemName)" name="txtUiNo@(itemName)"
                                                        value=""
                                                        placeholder="請輸入統一編號"
                                                        data-msg-maxlength="必須少於 20 個字元" maxlength="20" readonly />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboInvoiceType@(itemName)">發票聯數<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <select class="form-control" id="cboInvoiceType@(itemName)" name="cboInvoiceType@(itemName)" data-rule-required="true" disabled></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtInvoiceDate@(itemName)">發票日期 </label>
                                            <div class="input-group col-12 col-md-9 col-lg-9">
                                                <input type="text" class="form-control" id="txtInvoiceDate@(itemName)" name="txtInvoiceDate@(itemName)"
                                                        placeholder="請輸入發票日期"
                                                        data-msg-required="請輸入發票日期"
                                                        data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))" />
                                                <div class="input-group-append">
                                                    <button type="button" class="btn btn-danger" style="height:35px;" onclick="$('#txtInvoiceDate@(itemName)').val('')" title="清除">
                                                        <i class="fas fa-eraser mt-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtInvoiceNo@(itemName)">發票號碼</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="text" class="form-control" id="txtInvoiceNo@(itemName)" name="txtInvoiceNo@(itemName)"
                                                        value=""
                                                        placeholder="請輸入發票號碼"
                                                        data-msg-maxlength="必須少於 50 個字元" maxlength="50" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboDepartmentNo@(itemName)">費用部門</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <select class="form-control" id="cboDepartmentNo@(itemName)" name="cboDepartmentNo@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabOther">
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboCurrencyCode@(itemName)">幣別<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <select class="form-control" id="cboCurrencyCode@(itemName)" name="cboCurrencyCode@(itemName)" data-rule-required="true" disabled></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtExchange@(itemName)">匯率<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" step="any" min="0" max="99999" class="form-control" id="txtExchange@(itemName)" name="txtExchange@(itemName)"
                                                       value="1"
                                                       placeholder="請輸入匯率"
                                                       data-msg-required="請輸入匯率" data-rule-required="true" readonly />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtRowCnt@(itemName)">件數<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtRowCnt@(itemName)" name="txtRowCnt@(itemName)"
                                                       value="0"
                                                       placeholder="請輸入件數"
                                                       data-msg-required="請輸入件數" data-rule-required="true" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtSupplierSo@(itemName)">廠商單號</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="text" class="form-control" id="txtSupplierSo@(itemName)" name="txtSupplierSo@(itemName)"
                                                       value="" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="cboPaymentTerm@(itemName)">付款條件<span class="text-danger">*</span></label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <select class="form-control" id="cboPaymentTerm@(itemName)" name="cboPaymentTerm@(itemName)"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-6 col-form-label">
                                        <label class="control control-solid control-solid-info control--checkbox" for="cbxAutoMaterialBilling@(itemName)">
                                            自動扣料
                                            <input type="checkbox" id="cbxAutoMaterialBilling@(itemName)" name="cbxAutoMaterialBilling@(itemName)" />
                                            <span class="control__indicator"></span>
                                        </label>
                                    </div>
                                    <div class="col-6 col-form-label">
                                        <label class="control control-solid control-solid-info control--checkbox" for="cbxSupplierPicking@(itemName)">
                                            廠供料自動扣料
                                            <input type="checkbox" id="cbxSupplierPicking@(itemName)" name="cbxSupplierPicking@(itemName)" />
                                            <span class="control__indicator"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabMoney">
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtOrigAmount@(itemName)">原幣加工金額</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" step="any" min="0" max="99999" class="form-control" id="txtOrigAmount@(itemName)" name="txtOrigAmount@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入原幣加工金額"
                                                        data-msg-required="請輸入原幣加工金額" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtOrigPreTaxAmount@(itemName)">原幣未稅金額</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtOrigPreTaxAmount@(itemName)" name="txtOrigPreTaxAmount@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入原幣未稅金額"
                                                        data-msg-required="請輸入原幣未稅金額" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtDeductAmount@(itemName)">原幣扣款金額</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtDeductAmount@(itemName)" name="txtDeductAmount@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入原幣未稅金額"
                                                        data-msg-required="請輸入原幣未稅金額" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtOrigPreTaxAmount@(itemName)">原幣稅額</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtOrigPreTaxAmount@(itemName)" name="txtOrigPreTaxAmount@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入原幣未稅金額"
                                                        data-msg-required="請輸入原幣未稅金額" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtOriginalAmountTotal@(itemName)">原幣金額合計</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtOriginalAmountTotal@(itemName)" name="txtOriginalAmountTotal@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入原幣金額合計"
                                                        data-msg-required="請輸入原幣金額合計" readonly />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12 ">
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtReceiptAmount@(itemName)">本幣進貨費用</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtReceiptAmount@(itemName)" name="txtReceiptAmount@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入本幣進貨費用"
                                                        data-msg-required="請輸入本幣進貨費用" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtPretaxAmount@(itemName)">本幣未稅金額</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtPretaxAmount@(itemName)" name="txtPretaxAmount@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入本幣未稅金額"
                                                        data-msg-required="請輸入本幣未稅金額" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtTaxAmount@(itemName)">本幣稅額</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtTaxAmount@(itemName)" name="txtTaxAmount@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入本幣未稅金額"
                                                        data-msg-required="請輸入本幣未稅金額" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtLocalAmountTotal@(itemName)">本幣金額合計</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtLocalAmountTotal@(itemName)" name="txtLocalAmountTotal@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入本幣金額合計"
                                                        data-msg-required="請輸入本幣金額合計" readonly />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-12 col-md-3 col-lg-3 col-form-label" for="txtQuantity@(itemName)">數量合計</label>
                                            <div class="col-12 col-md-9 col-lg-9">
                                                <input type="number" class="form-control" id="txtQuantity@(itemName)" name="txtQuantity@(itemName)"
                                                        value="0"
                                                        placeholder="請輸入數量合計"
                                                        data-msg-required="請輸入數量合計" readonly />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="card-footer text-center text-lg-right">
                <button type="button" class="btn btn-success read-status" onclick="Save@(itemName)()"><i class="fas fa-save"></i>儲存</button>
            </div>
        </div>
    </div>
</div>

@*單身彈出顯示*@
<div class="advanced-block">
    <div class="row">
        <div class="col-12">
            <ul class="nav flag-tabs nav-fill" role="tablist">
                <li class="flag-item">
                    <a class="flag-link active" data-toggle="tab" href="#tabMweDetail">
                        <i class="fas fa-garage-car"></i> 入庫單單身
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="tab-content">
        <div class="tab-pane active" id="tabMweDetail">
            @Html.Partial("MweDetail")
        </div>
    </div>
</div>

<!--托外進貨週期單彈出-->
<div class="modal fade" id="modalQueryProjectOutCycle@(itemName)">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">搜尋</h5>
                <button class="close" data-dismiss="modal" type="button">
                    <span aria-hidden="true"><i class="fas fa-times"></i></span>
                </button>
            </div>
            <div class="modal-body">
                <form class="container" autocomplete="off" id="queryForm@(itemName)">
                    <fieldset>
                        <div class="form-group row">
                            <div class="col-6">
                                <input type="text" class="form-control" id="txtStartDocDateProjectOutCycleQ@(itemName)" name="txtStartDocDateProjectOutCycleQ@(itemName)"
                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                       readonly />
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control" id="txtEndDocDateProjectOutCycleQ@(itemName)" name="txtEndDocDateProjectOutCycleQ@(itemName)"
                                       data-msg-extraRegex="請輸入正確的日期格式" data-rule-extraRegex="([12]\d{3}\-(0[1-9]|1[0-2])\-(0[1-9]|[12]\d|3[01]))"
                                       readonly />
                            </div>
                        </div>                        
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="cbConfirmStatusProjectOutCycleQ@(itemName)">確認狀態</label>
                            <div class="col-12">
                                <select class="form-control" id="cbConfirmStatusProjectOutCycleQ@(itemName)" name="cbConfirmStatusProjectOutCycleQ@(itemName)">
                                    <option value="">-- 請選擇確認狀態 --</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-12 col-form-label" for="cboCheckoutStatusProjectOutCycleQ@(itemName)">結帳狀態</label>
                            <div class="col-12">
                                <select class="form-control" id="cboCheckoutStatusProjectOutCycleQ@(itemName)" name="cboCheckoutStatusProjectOutCycleQ@(itemName)">
                                    <option value="">-- 請選擇結帳狀態 --</option>
                                </select>
                            </div>
                        </div>                        
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="ExcelProjectOutCycle@(itemName)()" style="margin: auto;"><i class="fal fa-wrench"></i>套用</button>
            </div>
        </div>
    </div>
</div>

@Html.Resource("js",
    @<script>
        let objPage@(itemName) = {
            "pageIndex": 0,
            "pageSize": 10
        };

        let userId@(itemName);
        let companyId@(itemName);
        let userNo@(itemName);

        let objForm@(itemName) = "#editForm@(itemName)";

        $(document).ready(function () {
            let RequestMweFullErpNo = "@RequestMweFullErpNo";
            if (RequestMweFullErpNo) {
                $("#txtMweErpFullNoQ@(itemName)").val(RequestMweFullErpNo);
            }
            GetUserInfo@(itemName)()

            ComboBoxs.WithText("#cboMweErpPrefixQ@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "UserNo": userNo@(itemName), "ColumnName": "MoErpPrefix" }, "", "NA", "", "MweErpPrefixName", "MweErpPrefix"); //入庫單單別
            ComboBoxs.Default("#cbConfirmStatusQ@(itemName)", "@Url.Action("GetStatus", "BasicInformation")", { "StatusSchema": "ConfirmStatus" }, "", "NA", "", "StatusName", "StatusNo"); //入庫單確認碼
            //ComboBoxs.Default("#cboTransferStatusQ@(itemName)", "@Url.Action("GetStatus", "BasicInformation")", { "StatusSchema": "Boolean" }, "", "NA", "", "StatusName", "StatusNo"); //入庫單拋轉狀態
            ComboBoxs.WithText("#cboWoErpPrefixQ@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "UserNo": userNo@(itemName), "ColumnName": "WipErpPrefix" }, "", "NA", "", "WoErpPrefixName", "WoErpPrefix"); //製令單別
            ComboBoxs.WithText("#cboInventoryIdQ@(itemName)", "@Url.Action("GetInventory", "ScmBasicInformation")", {}, "", "NA", "", "InventoryWithNo", "InventoryId"); //入庫庫別

            //ComboBoxs.Default("#cboSupplierIdQ@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, "", "NA", "", "SupplierWithNo", "SupplierId");

            //搜尋日期區間條件
            let currentDate = new Date();
            //單據日期
            @*Suites.DateDropper("#txtStartDocDateQ@(itemName),#txtEndDocDateQ@(itemName)");
            Suites.SetDateDropper("#txtEndDocDateQ@(itemName)", currentDate);
            currentDate.setDate(currentDate.getDate() - 7);
            Suites.SetDateDropper("#txtStartDocDateQ@(itemName)", currentDate);*@

            Suites.DatePicker("txtEndDocDateQ@(itemName)", currentDate);
            currentDate.setDate(currentDate.getDate() - 30);
            Suites.DatePicker("txtStartDocDateQ@(itemName)", currentDate);

            currentDate = new Date();
            //進貨日期
            @*Suites.DateDropper("#txtStartReceiptDateQ@(itemName),#txtEndReceiptDateQ@(itemName)");
            Suites.SetDateDropper("#txtEndReceiptDateQ@(itemName)", currentDate);
            currentDate.setDate(currentDate.getDate() - 7);
            Suites.SetDateDropper("#txtStartReceiptDateQ@(itemName)", currentDate);*@

            Suites.DatePicker("txtStartDocDateProjectOutCycleQ@(itemName)", currentDate);
            Suites.DatePicker("txtEndDocDateProjectOutCycleQ@(itemName)", currentDate);

            ComboBoxs.Default("#cbConfirmStatusProjectOutCycleQ@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "ConfirmStatusProjectOutCycle" }, "", "ALL", "", "TypeName", "TypeNo");
            ComboBoxs.Default("#cboCheckoutStatusProjectOutCycleQ@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "CheckoutStatusProjectOutCycle" }, "", "ALL", "", "TypeName", "TypeNo");

            if (!isMobile) {
                $("#cboMweErpPrefixQ@(itemName), #cbConfirmStatusQ@(itemName), #cboWoErpPrefixQ@(itemName), #cboInventoryIdQ@(itemName)").select2({
                    dropdownAutoWidth: true,
                    width: "100%"
                });
            }

            $("#cboMweErpPrefix@(itemName)").change(function () {
                if ($("#cboMweErpPrefix@(itemName)").val() == "5903") {
                    ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, "", "NA", "", "SupplierWithNo", "SupplierId");
                }
                else if ($("#cboMweErpPrefix@(itemName)").val() == "5902") {
                    alert("如欲開立5902入庫單,請使用托外生產管理模組開立")
                    $("#cboMweErpPrefix@(itemName)").val("5901")
                    if (companyId@(itemName) == 2) {
                        ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, 177, "NA", "", "SupplierWithNo", "SupplierId");
                    } else if (companyId@(itemName) == 4) {
                        ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, 3224, "NA", "", "SupplierWithNo", "SupplierId");
                    }
                }
                else {
                    if (companyId@(itemName) == 2) {
                        ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, 177, "NA", "", "SupplierWithNo", "SupplierId");
                    }
                    else if (companyId@(itemName) == 3) {
                        ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, 3622, "NA", "", "SupplierWithNo", "SupplierId");
                    }
                    else if (companyId@(itemName) == 4) {
                        ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, 3224, "NA", "", "SupplierWithNo", "SupplierId");
                    }
                }
            })

            $("#txtDocDate@(itemName)").change(function () {
                $("#txtReceiptDate@(itemName)").val($("#txtDocDate@(itemName)").val())
            })

            //報表選擇日期
            Suites.DatePicker("txtStartReceiptDateQ@(itemName)", currentDate);
            Suites.DatePicker("txtEndReceiptDateQ@(itemName)", currentDate);

            Query@(itemName)();
        });

        function Query@(itemName)() {
            //objPage@(itemName).pageIndex = 0;
            InitData@(itemName)(objPage@(itemName));

            $("#modalQuery@(itemName)").modal("hide");
        }

        function InitData@(itemName)(objPage) {
            let innerHtml = '';
            let pageCount = 0;

            let targetUrl = "@Url.Action("GetMoWarehouseEnry", "Inventory")";
            let postData = {
                "OrderBy": "",
                "PageIndex": (objPage.pageIndex + 1),
                "PageSize": objPage.pageSize,
                "MweErpPrefix": $("#cboMweErpPrefixQ@(itemName)").val(),
                "MweErpFullNo": $("#txtMweErpFullNoQ@(itemName)").val().trim(),
                "StartDocDate": ($("#cbxDocDateQ@(itemName)").is(":checked") ? $("#txtStartDocDateQ@(itemName)").val() : ""),
                "EndDocDate": ($("#cbxDocDateQ@(itemName)").is(":checked") ? $("#txtEndDocDateQ@(itemName)").val() : ""),
                "StartReceiptDate": ($("#cbxReceiptDateQ@(itemName)").is(":checked") ? $("#txtStartReceiptDateQ@(itemName)").val() : ""),
                "EndReceiptDate": ($("#cbxReceiptDateQ@(itemName)").is(":checked") ? $("#txtEndReceiptDateQ@(itemName)").val() : ""),
                "ConfirmStatus": $("#cbConfirmStatusQ@(itemName)").val(),
                "TransferStatus": $("#cboTransferStatusQ@(itemName)").val(),
                "WoErpPrefix": $("#cboWoErpPrefixQ@(itemName)").val(),
                "WoErpFullNo": $("#txtWoErpFullNoQ@(itemName)").val(),
                "MtlItemNo": $("#txtMtlItemNoQ@(itemName)").val(),
                "InventoryId": $("#cboInventoryIdQ@(itemName)").val(),
                "CreateBy": $("#txtMweCreateByQ@(itemName)").val()
            };
            let data = DataAccess.Get(targetUrl, postData, false);

            if (data.status == "success") {
                pageCount = data.result.length > 0 ? parseInt(data.result[0]["TotalCount"]) : 0;

                if (pageCount > 0) {
                    objPage = PageCaculate(pageCount, objPage);
                    $.each(data.result, function (i, item) {
                        let _row = (objPage.pageSize * objPage.pageIndex + (i + 1)) + ".";
                        TransferStatus = item.TransferStatus;
                        ReConfirmStatus = item.ReConfirmStatus;
                        var TransferStatusText = "";
                        if (TransferStatus == "N" && ReConfirmStatus == null) {
                            TransferStatusText = "未拋轉"
                        }
                        else if (TransferStatus && ReConfirmStatus == "Y") {
                            TransferStatusText = "重新編輯中"
                        }
                        else if (TransferStatus == "Y" && ReConfirmStatus == "N") {
                            TransferStatusText = "已拋轉"
                        }
                        else {
                            TransferStatusText = "異常"
                        }

                        innerHtml += `<tr>
                                        <td class="col-sticky">${_row}</td>
                                            <td class="text-center active-content" >
                                            <div class="btn-group mb-4 show" style="margin-bottom: 0 !important; position: static;">
                                                <button type="button" class="btn btn-primary dropdown-toggle" data-mwe-id="${item.MweId}" style="padding-top: 0; padding-bottom: 0;">動作</button>
                                                <div class="dropdown-menu btn-text-left-block" data-mwe-id="${item.MweId}" style="overflow-y: auto; z-index: 999; max-height: 150px;">
                                                    ${item.TransferStatus == `Y` ? `<a class="dropdown-item btn-text-left auth-read" href="javascript:Read@(itemName)(${item.MweId},'U');"><i class="fas fa-eye"></i>查看</a>` : ``}
                                                    ${item.ConfirmStatus == `N` ? `<a class="dropdown-item btn-text-left auth-update" href="javascript:Edit@(itemName)(${item.MweId});"><i class="fas fa-edit"></i>編輯</a>` : ``}
                                                    ${item.TransferStatus == `N` ? `<a class="dropdown-item btn-text-left auth-delete" href="javascript:Delete@(itemName)(${item.MweId});"><i class="fas fa-trash-alt"></i>刪除</a>` : ``}
                                                    ${item.ConfirmStatus == `N` ? `<a class="dropdown-item btn-text-left auth-import" href="javascript:TransferErp@(itemName)(${item.MweId});" ><i class="far fa-arrow-alt-square-up"></i><span>拋轉</span></a>` : ``}
                                                    @*${item.TransferStatus == `Y` && item.ConfirmStatus == `N` ? `<a class="active-link auth-confirm2" href="javascript:Confirm@(itemName)(${item.MweId},1);" ><i class="fas fa-check"></i><span>核單</span></a>` : `<a class="active-link auth-confirm2 active-disable" href="javascript:void(0);"><i class="fas fa-check"></i><span>核單</span></a>`}
                                                    ${item.ConfirmStatus == `Y` ? `<a class="active-link auth-reconfirm2" href="javascript:ReConfirm@(itemName)(${item.MweId},1);"><i class="fas fa-undo-alt"></i><span>反確認</span></a>` : `<a class="active-link auth-reconfirm2 active-disable" href="javascript:void(0);"><i class="fas fa-undo-alt"></i><span>反確認</span></a>`}*@
                                                    ${item.TransferStatus == `Y` && item.ConfirmStatus == `N` ? `<a class="dropdown-item btn-text-left auth-confirm" href="javascript:Confirm@(itemName)(${item.MweId},2);" ><i class="fas fa-check"></i><span>核單</span></a>` : ``}
                                                    ${item.ConfirmStatus == `Y` ? `<a class="dropdown-item btn-text-left auth-reconfirm" href="javascript:ReConfirm@(itemName)(${item.MweId},2);"><i class="fas fa-undo-alt"></i><span>反確認</span></a>` : ``}
                                                    ${item.ConfirmStatus == `Y` || (item.TransferStatus == `Y` && item.ReConfirmStatus == `N` && item.ConfirmStatus != `V`) ? `<a class="dropdown-item btn-text-left auth-void" href="javascript:MweVoid@(itemName)(${item.MweId});"><i class="fas fa-ban"></i><span>作廢</span></a>` : ``}
                                                    <a class="dropdown-item btn-text-left auth-detail" href="javascript:Detail@(itemName)(${item.MweId});"><i class="fas fa-list"></i><span>單身</span></a>
                                                    <a class="dropdown-item btn-text-left auth-print" href="javascript:Print@(itemName)(${item.MweId});"><i class="fas fa-print"></i><span>列印</span></a>
                                                 </div>
                                            </div>
                                         </td>
                                        <td class="ellipsis col-sticky" data-toggle="tooltip" title="${item.MweErpPrefix}-${item.MweErpNo}" style="max-width: 200px;">${item.MweErpPrefix}-${item.MweErpNo}</td>
                                        <td>${item.DocDate}</td>
                                        <td>${item.ReceiptDate}</td>
                                        <td class="text-center">${InputStatusContent(`S`, `ConfirmStatus`, item.ConfirmStatus)}</td>
                                        <td class="text-center">${TransferStatusText}</td>
                                        <td class="text-center">${item.UserName}</td>
                                        <td class="text-center">${item.ConfirmUserName}</td>


                                      </tr>
                                      <tr data-wo-id="${item.MweId}" style="display: none;">
                                        <td colspan="12">
                                          <table style="width: 100%; margin: auto; border: 1px solid #d7d7e1;">
                                            <thead>
                                             <tr>
                                                <th class="thead-customized" scope="col">#</th>
                                                <th class="thead-customized" scope="col">ERP製令</th>
                                                <th class="thead-customized" scope="col">產品品號</th>
                                                <th class="thead-customized" scope="col">產品品名</th>
                                                <th class="thead-customized" scope="col">庫別</th>
                                                <th class="thead-customized" scope="col">進貨數量</th>
                                              </tr>
                                           </thead>
                                            <tbody>
                                            </tbody>
                                          </table>
                                        </td>
                                      </tr>`;
                    });
                }else {
                    innerHtml += `<tr>
                                    <td class="text-center" colspan="12" style="background-color: #fff3cd;">
                                      <i class="fal fa-exclamation-circle"></i>&nbsp;目前尚無資料。
                                    </td>
                                  </tr>`;
                }
            } else {
                alert(data.msg, "alert", 0);
            }

            $("#tblData@(itemName) tbody").html(innerHtml);
            TableComponentInit();
            Pager("#page@(itemName)", pageCount, objPage, InitData@(itemName));

            $(".dropdown-toggle").off("click").on("click", function () {
                let mweid = $(this).data("mwe-id");

                if ($(`.dropdown-menu[data-mwe-id='${mweid}']`).hasClass("show")) {
                    $(".dropdown-menu").removeClass("show");
                } else {
                    $(".dropdown-menu").removeClass("show");

                    $(`.dropdown-menu[data-mwe-id='${mweid}']`).addClass("show");
                    $(`.dropdown-menu[data-mwe-id='${mweid}']`).css({
                        top: `${$(this).position().top + $(this).height() + 5}px`,
                        left: `${$(this).position().left - $(this).width() + 38}px`
                    });
                }
            });

            $("body").off("click").on("click", function (e) {
                if ($(".dropdown-menu").hasClass("show")) {
                    if (!$(e.target).hasClass("dropdown-toggle")
                        && !$(e.target).parents().hasClass("dropdown-toggle")) {
                        $(".dropdown-menu").removeClass("show");
                    }
                }
            });
        }

        function Read@(itemName)(MweId) {
            $("#TransferStatus").val("Y");
            $("#MweId").val(MweId ? MweId : 0);
            $("#txtDocDate@(itemName)").attr("disabled", true);
            $("#txtReceiptDate@(itemName)").attr("disabled", true);
            $("#cboMweErpPrefix@(itemName)").attr("disabled", true);
            $("#txtMweErpNo@(itemName)").attr("readonly", true);
            $("#cboSupplierId@(itemName)").attr("disabled", true);
            $("#txtRemark@(itemName)").attr("readonly", true);
            $("#cboDeductType@(itemName)").attr("disabled", true);
            $("#txtInvoiceDate@(itemName)").attr("readonly", true);
            $("#txtInvoiceNo@(itemName)").attr("readonly", true);
            $("#cboDepartmentNo@(itemName)").attr("disabled", true);
            $("#txtRowCnt@(itemName)").attr("readonly", true);
            $("#txtSupplierSo@(itemName)").attr("readonly", true);
            $("#cboPaymentTerm@(itemName)").attr("disabled", true);
            $("#cbxAutoMaterialBilling@(itemName)").attr("disabled", true);
            $("#cbxSupplierPicking@(itemName)").attr("disabled", true);

            $(".read-status").hide()
            $("#TransferErp").hide()
            $("#ReConfirmErp").show()
            Switch("#editData@(itemName), .unit-block", "#listData@(itemName)");

            //下拉選單

            //入庫單單別選單
            ComboBoxs.WithText("#cboMweErpPrefix@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "MoErpPrefix" }, "", "NA", "", "MweErpPrefixName", "MweErpPrefix"); //製令單別
            //加工廠商資料選單
            ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, "", "NA", "", "SupplierWithNo", "SupplierId");
            //扣抵區分選單
            ComboBoxs.WithText("#cboDeductType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "OspReceipt.DeductType" }, "", "NA", "", "TypeName", "TypeNo");
            //稅別碼選單
            ComboBoxs.WithText("#cboTaxCode@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TaxNo" }, "", "NA", "", "TaxName", "TaxNo");
            //課稅別選單
            ComboBoxs.Default("#cboTaxType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Taxation" }, "", "NA", "", "TypeName", "TypeNo");
            //發票聯數選單
            ComboBoxs.Default("#cboInvoiceType@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "InvoiceCount" }, "", "CHOOSE", "", "InvoiceCountName", "InvoiceCountNo");
            //部門選單
            ComboBoxs.Default("#cboDepartmentNo@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "Department" }, "", "CHOOSE", "請選擇", "DepartmentName", "DepartmentNo");
            //幣別選單
            ComboBoxs.WithText("#cboCurrencyCode@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "Currency" }, "", "NA", "", "CurrencyName", "Currency");
            //付款條件選單
            ComboBoxs.Default("#cboPaymentTerm@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "PaymentTerm" }, "", "NA", "", "PaymentTermName", "PaymentTermNo");

            if (MweId > 0) {
                let targetUrl = "@Url.Action("GetMoWarehouseEnry", "Inventory")";
                let postData = {
                    "MweId": MweId
                };
                let data = DataAccess.Get(targetUrl, postData, false);

                if (data.status == "success") {
                    $.each(data.result, function (i, item) {


                        if (item.DocDate != null) Suites.SetDateDropper("#txtDocDate@(itemName)", new Date(item.DocDate));
                        if (item.ReceiptDate != null) Suites.SetDateDropper("#txtReceiptDate@(itemName)", new Date(item.ReceiptDate));

                        if (item.MweErpPrefix == "5902" || item.MweErpPrefix == "5903") {
                            $("#MoneyDataShow").val("Y");
                        }
                        else {
                            $("#MoneyDataShow").val("N");
                        }

                        if (item.TransferStatus == "N") {
                            $("#MweStatus").val("S")
                        }
                        else if (item.TransferStatus == "Y") {
                            $("#MweStatus").val("T")
                            if (item.ConfirmStatus == "Y") {
                                $("#MweStatus").val("C")
                            }


                        }

                        $("#cboMweErpPrefix@(itemName)").val(item.MweErpPrefix);
                        $("#txtMweErpNo@(itemName)").val(item.MweErpNo);
                        $("#txtRemark@(itemName)").val(item.Remark);
                        $("#TransferStatus").val(item.TransferStatus);
                        $("#cboSupplierId@(itemName)").val(item.SupplierId);
                        $("#SupplierNo").val(item.SupplierNo);
                        $("#cboTaxCode@(itemName)").val(item.TaxCode);
                        $("#cboTaxType@(itemName)").val(item.TaxType);
                        $("#txtTaxRate@(itemName)").val(item.TaxRate);


                        $("#txtUiNo@(itemName)").val(item.UiNo);
                        $("#txtInvoiceDate@(itemName)").val(item.InvoiceDate);
                        $("#txtInvoiceNo@(itemName)").val(item.InvoiceNo);

                        $("#txtApplyYYMM@(itemName)").val(item.ApplyYYMM.substr(0, 4) + "-" + item.ApplyYYMM.substr(4, 2));
                        $("#cboDepartmentNo@(itemName)").val(item.DepartmentNo.trim());
                        $("#cboInvoiceType@(itemName)").val(item.InvoiceType);
                        $("#cboDeductType@(itemName)").val(item.DeductType);
                        $("#cboCurrencyCode@(itemName)").val(item.CurrencyCode);
                        $("#txtExchange@(itemName)").val(item.Exchange);
                        $("#txtSupplierSo@(itemName)").val(item.SupplierSo);
                        $("#txtRowCnt@(itemName)").val(item.RowCnt);
                        $("#cboPaymentTerm@(itemName)").val(item.PaymentTerm);
                        if (item.AutoMaterialBilling == "Y") {
                            $("#cbxAutoMaterialBilling@(itemName)").attr("checked", true);
                        } else {
                            $("#cbxAutoMaterialBilling@(itemName)").attr("checked", false);
                        };
                        if (item.SupplierPicking == "Y") {
                            $("#cbxSupplierPicking@(itemName)").attr("checked", true);
                        } else {
                            $("#cbxSupplierPicking@(itemName)").attr("checked", false);
                        };

                        //原幣金額
                        var OrigAmount = parseInt(item.OrigAmount)
                        var OrigPreTaxAmount = parseInt(item.OrigPreTaxAmount)
                        var DeductAmount = parseInt(item.DeductAmount)
                        var OrigTax = parseInt(item.OrigTax)
                        var OriginalAmountTotal = parseInt(OrigAmount - DeductAmount + OrigTax)
                        //本幣金額
                        var OrigTax = parseInt(item.OrigTax)
                        var ReceiptAmount = parseInt(item.ReceiptAmount)
                        var PretaxAmount = parseInt(item.PretaxAmount)
                        var TaxAmount = parseInt(item.TaxAmount)
                        var LocalAmountTotal = parseInt(PretaxAmount + TaxAmount)

                        $("#txtOrigAmount@(itemName)").val(OrigAmount); //原幣加工金額
                        $("#txtOrigPreTaxAmount@(itemName)").val(OrigPreTaxAmount); //原幣未稅金額
                        $("#txtDeductAmount@(itemName)").val(DeductAmount); //原幣扣款金額
                        $("#txtOrigPreTaxAmount@(itemName)").val(OrigTax); //原幣稅額
                        $("#txtOriginalAmountTotal@(itemName)").val(OriginalAmountTotal); //原幣金額合計
                        $("#txtReceiptAmount@(itemName)").val(ReceiptAmount); //本幣進貨費用
                        $("#txtPretaxAmount@(itemName)").val(PretaxAmount); //本幣未稅金額
                        $("#txtTaxAmount@(itemName)").val(TaxAmount); //本幣稅額
                        $("#txtLocalAmountTotal@(itemName)").val(LocalAmountTotal); //本幣金額合計
                        $("#txtQuantity@(itemName)").val(item.Quantity); //數量合計

                        if (item.TransferStatus == "Y") {
                            if (item.ConfirmStatus == "Y") {
                                $("#TransferErp").hide()
                                $("#ConfirmErp").hide()
                                $("#ReConfirmErp").show()
                            }
                            else {
                                $("#TransferErp").hide()
                                $("#ConfirmErp").show()
                                $("#ReConfirmErp").hide()
                            }
                        }
                    });
                        ExpandMweDetail();
                } else {
                    alert(data.msg, "alert", 0);
                }
            }
        }

        function Edit@(itemName)(MweId, ScrapRegister) {
            $("#MweId").val(MweId ? MweId : 0);
            $("#txtDocDate@(itemName)").attr("disabled", false);
            $("#txtReceiptDate@(itemName)").attr("disabled", true);
            $("#cboMweErpPrefix@(itemName)").attr("disabled", false);
            $("#txtMweErpNo@(itemName)").attr("readonly", true);
            $("#cboSupplierId@(itemName)").attr("disabled", false);
            $("#txtRemark@(itemName)").attr("readonly", false);
            $("#cboDeductType@(itemName)").attr("disabled", false);
            $("#txtInvoiceDate@(itemName)").attr("readonly", false);
            $("#txtInvoiceNo@(itemName)").attr("readonly", false);
            $("#cboDepartmentNo@(itemName)").attr("disabled", false);
            $("#txtRowCnt@(itemName)").attr("readonly", false);
            $("#txtSupplierSo@(itemName)").attr("readonly", false);
            $("#cboPaymentTerm@(itemName)").attr("disabled", false);
            $("#cbxAutoMaterialBilling@(itemName)").attr("disabled", false);
            $("#cbxSupplierPicking@(itemName)").attr("disabled", false);

            $(".read-status").show()
            $("#MweStatus").val("")

            //日期欄位 Suites.DateDropper(功能開啟) Suites.SetDateDropper(日期設置)
            //Suites.DateDropper("#txtDocDate@(itemName),#txtInvoiceDate@(itemName)");
            //開單日預設今日
            let currentDate = new Date();
            Suites.DatePicker("txtDocDate@(itemName)", currentDate);
            Suites.DatePicker("txtReceiptDate@(itemName)", currentDate);
            //Suites.SetDateDropper("#txtDocDate@(itemName), #txtReceiptDate@(itemName)", currentDate);
            let Today = new Date();
            $("#txtApplyYYMM@(itemName)").val(Today.getFullYear().toString() + "-" + ((Today.getMonth() + 1)).toString().padStart(2, '0'));

            Switch("#editData@(itemName), .unit-block", "#listData@(itemName)");

            //入庫單單別選單
            ComboBoxs.WithText("#cboMweErpPrefix@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "MoErpPrefix" }, "", "NA", "", "MweErpPrefixName", "MweErpPrefix"); //製令單別
            //加工廠商資料選單
            ComboBoxs.Default("#cboSupplierId@(itemName)", "@Url.Action("GetSupplier", "ScmBasicInformation")", { "PermitStatus": "1" }, "", "NA", "", "SupplierWithNo", "SupplierId");
            //扣抵區分選單
            ComboBoxs.WithText("#cboDeductType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "OspReceipt.DeductType" }, "", "NA", "", "TypeName", "TypeNo");
            //稅別碼選單
            ComboBoxs.WithText("#cboTaxCode@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TaxNo" }, "", "NA", "", "TaxName", "TaxNo");
            //課稅別選單
            ComboBoxs.Default("#cboTaxType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Taxation" }, "", "NA", "", "TypeName", "TypeNo");
            //發票聯數選單
            ComboBoxs.Default("#cboInvoiceType@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "InvoiceCount" }, "", "CHOOSE", "", "InvoiceCountName", "InvoiceCountNo");
            //部門選單
            ComboBoxs.Default("#cboDepartmentNo@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "Department" }, "", "CHOOSE", "請選擇", "DepartmentName", "DepartmentNo");
            //幣別選單
            ComboBoxs.WithText("#cboCurrencyCode@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "Currency" }, "", "NA", "", "CurrencyName", "Currency");
            //付款條件選單
            ComboBoxs.Default("#cboPaymentTerm@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "PaymentTerm" }, "", "NA", "", "PaymentTermName", "PaymentTermNo");

            if (companyId@(itemName) == 2) {
                $("#cboMweErpPrefix@(itemName)").val("5901")
                $("#cboSupplierId@(itemName)").val(177)
                $("#cboDeductType@(itemName)").val("3")
                $("#cboTaxCode@(itemName)").val("P16")
                $("#cboTaxType@(itemName)").val("4")
                $("#cboInvoiceType@(itemName)").val("6")
                $("#cboCurrencyCode@(itemName)").val("NT$")
                $("#cboPaymentTerm@(itemName)").val("1007")
                $("#txtUiNo@(itemName)").val(54258218);
            }
            else if (companyId@(itemName) == 3) {
                $("#cboMweErpPrefix@(itemName)").val("5904")
                $("#cboSupplierId@(itemName)").val(3622)
                $("#cboDeductType@(itemName)").val("3")
                $("#cboTaxCode@(itemName)").val("P16")
                $("#cboTaxType@(itemName)").val("4")
                $("#cboInvoiceType@(itemName)").val("6")
                $("#cboCurrencyCode@(itemName)").val("NTD")
                $("#cboPaymentTerm@(itemName)").val("101")
                $("#txtUiNo@(itemName)").val(54899500);
            }
            else if (companyId@(itemName) == 4) {
                $("#cboMweErpPrefix@(itemName)").val("5901")
                $("#cboSupplierId@(itemName)").val(2306)
                $("#cboDeductType@(itemName)").val("3")
                $("#cboTaxCode@(itemName)").val("006")
                $("#cboTaxType@(itemName)").val("4")
                $("#cboInvoiceType@(itemName)").val("C")
                $("#cboCurrencyCode@(itemName)").val("CNY")
                $("#cboPaymentTerm@(itemName)").val("")
                $("#txtUiNo@(itemName)").val("");
            }


            $("#cbxAutoMaterialBilling@(itemName)").attr("checked", false);
            $("#cbxSupplierPicking@(itemName)").attr("checked", false);
            $("#txtOrigAmount@(itemName)").val(0); //原幣加工金額
            $("#txtOrigPreTaxAmount@(itemName)").val(0); //原幣未稅金額
            $("#txtDeductAmount@(itemName)").val(0); //原幣扣款金額
            $("#txtOrigPreTaxAmount@(itemName)").val(0); //原幣稅額
            $("#txtOriginalAmountTotal@(itemName)").val(0); //原幣金額合計
            $("#txtReceiptAmount@(itemName)").val(0); //本幣進貨費用
            $("#txtPretaxAmount@(itemName)").val(0); //本幣未稅金額
            $("#txtTaxAmount@(itemName)").val(0); //本幣稅額
            $("#txtLocalAmountTotal@(itemName)").val(0); //本幣金額合計
            $("#txtQuantity@(itemName)").val(0); //數量合計

            $("#cboTaxCode@(itemName)").on("change", function () {
                ComboBoxs.Default("#cboInvoiceType@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "InvoiceCount", "Condition": $("#cboTaxCode@(itemName)").val("") }, "", "CHOOSE", "", "InvoiceCountName", "InvoiceCountNo");

                let taxation;
                let targetUrl = "@Url.Action("GetErpData", "BasicInformation")";
                let postData = {
                    "ColumnName": "TaxNo",
                    "Condition": $("#cboTaxCode@(itemName)").val()
                };

                let data = DataAccess.Get(targetUrl, postData, false);

                if (data.status == "success") {
                    $.each(data.result, function (i, item) {
                        taxation = item.Taxation;
                        $("#txtTaxRate@(itemName)").val(parseFloat(item.BusinessTaxRate));
                    });
                }

                ComboBoxs.Default("#cboTaxType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Taxation" }, taxation, "NA", "", "TypeName", "TypeNo");
            });

            $("#cboCurrencyCode@(itemName)").change(function () {
                //匯率
                targetUrl = "@Url.Action("GetErpData", "BasicInformation")";
                postData = {
                    "ColumnName": "ExchangeRate",
                    "Condition": $("#cboCurrencyCode@(itemName)").val()
                };
                data = DataAccess.Get(targetUrl, postData, false);
                if (data.status == "success") {
                    $.each(data.result, function (i, item) {
                        $("#txtExchange@(itemName)").val(item.ExchangeRateNameForMwe)
                    });
                }
            });

            $("#cboSupplierId@(itemName)").change(function () {
                let targetUrl = "@Url.Action("GetSupplier", "ScmBasicInformation")";
                let postData = {
                    "SupplierId": $(this).val()
                };
                let data = DataAccess.Get(targetUrl, postData, false);

                if (data.status == "success") {
                    if (data.result.length > 0) {
                        $.each(data.result, function (i, item) {
                            //稅別碼
                            ComboBoxs.WithText("#cboTaxCode@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "TaxNo" }, "", "NA", "", "TaxName", "TaxNo");
                            $("#cboTaxCode@(itemName)").val(item.TaxNo);

                            ComboBoxs.Default("#cboInvoiceType@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "InvoiceCount", "Condition": $("#cboTaxCode@(itemName)").val() }, "", "CHOOSE", "", "InvoiceCountName", "InvoiceCountNo");
                            let taxation;
                            let targetUrl = "@Url.Action("GetErpData", "BasicInformation")";
                            let postData = {
                                "ColumnName": "TaxNo",
                                "Condition": $("#cboTaxCode@(itemName)").val()
                            };
                            let data = DataAccess.Get(targetUrl, postData, false);
                            if (data.status == "success") {
                                $.each(data.result, function (i, item) {
                                    taxation = item.Taxation;
                                    $("#txtTaxRate@(itemName)").val(parseFloat(item.BusinessTaxRate));
                                });
                            }
                            ComboBoxs.Default("#cboTaxType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "Customer.Taxation" }, taxation, "NA", "", "TypeName", "TypeNo");
                            if (taxation == "3" || taxation == "4" || taxation == "9") {
                                ComboBoxs.WithText("#cboDeductType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "OspReceipt.DeductType" }, "3", "NA", "", "TypeName", "TypeNo");
                            }
                            else {
                                ComboBoxs.WithText("#cboDeductType@(itemName)", "@Url.Action("GetType", "BasicInformation")", { "TypeSchema": "OspReceipt.DeductType" }, "1", "NA", "", "TypeName", "TypeNo");
                            }
                            $("#txtUiNo@(itemName)").val(item.GuiNumber);

                            //交易幣別
                            ComboBoxs.WithText("#cboCurrencyCode@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "Currency" }, "", "NA", "", "CurrencyName", "Currency");
                            $("#cboCurrencyCode@(itemName)").val(item.Currency);

                            //匯率
                            targetUrl = "@Url.Action("GetErpData", "BasicInformation")";
                            postData = {
                                "ColumnName": "ExchangeRate",
                                "Condition": $("#cboCurrencyCode@(itemName)").val()
                            };
                            data = DataAccess.Get(targetUrl, postData, false);
                            if (data.status == "success") {
                                $.each(data.result, function (i, item) {
                                    $("#txtExchange@(itemName)").val(item.ExchangeRateNameForMwe)
                                });
                            }

                            //付款條件
                            ComboBoxs.Default("#cboPaymentTerm@(itemName)", "@Url.Action("GetErpData", "BasicInformation")", { "ColumnName": "PaymentTerm" }, "", "NA", "", "PaymentTermName", "PaymentTermNo");
                            $("#cboPaymentTerm@(itemName)").val(item.PaymentTerm);
                        });
                    }
                }
            });


            if (MweId > 0) {
                let targetUrl = "@Url.Action("GetMoWarehouseEnry", "Inventory")";
                let postData = {
                    "MweId": MweId
                };
                let data = DataAccess.Get(targetUrl, postData, false);

                if (data.status == "success") {
                    $.each(data.result, function (i, item) {
                        //按鈕控制
                        if (item.TransferStatus == "N") {
                            $("#MweStatus").val("S")
                        }
                        else if (item.TransferStatus == "Y") {
                            $("#MweStatus").val("T")

                            if (item.ReConfirmStatus == "Y") {
                                $(".read-status").show()
                            }
                            else if (item.ReConfirmStatus == "N") {
                                $("#MweStatus").val("TP")
                                $(".read-status").hide()
                            }
                        }
                        else {
                            alert("入庫單拋轉狀態有問題")
                            return
                        }

                        if (item.ConfirmStatus == "Y") {
                            $("#MweStatus").val("C")
                            $(".read-status").hide()
                        }

                        $("#cboMweErpPrefix@(itemName)").attr("disabled", true);
                        $("#cboSupplierId@(itemName)").attr("disabled", true);

                        //如果有拋轉過就不能更改開單日
                        if (item.TransferStatus == "Y") {
                            //$('#txtDocDate@(itemName)').dateDropper('destroy');
                            $("#txtDocDate@(itemName)").attr("disabled", true);

                        }
                        //if (item.DocDate != null) Suites.SetDateDropper("#txtDocDate@(itemName)", new Date(item.DocDate));
                        //if (item.ReceiptDate != null) Suites.SetDateDropper("#txtReceiptDate@(itemName)", new Date(item.ReceiptDate));
                        if (item.DocDate != null) Suites.DatePicker("txtDocDate@(itemName)", new Date(item.DocDate));
                        if (item.ReceiptDate != null) Suites.DatePicker("txtReceiptDate@(itemName)", new Date(item.ReceiptDate));
                        if (item.MweErpPrefix == "5902" || item.MweErpPrefix == "5903") {
                            $("#MoneyDataShow").val("Y");
                        }
                        else {
                            $("#MoneyDataShow").val("N");
                        }
                        $("#cboMweErpPrefix@(itemName)").val(item.MweErpPrefix);
                        $("#txtMweErpNo@(itemName)").val(item.MweErpNo);
                        $("#txtRemark@(itemName)").val(item.Remark);
                        $("#TransferStatus").val(item.TransferStatus);
                        $("#cboSupplierId@(itemName)").val(item.SupplierId);
                        $("#SupplierNo").val(item.SupplierNo);
                        $("#cboTaxCode@(itemName)").val(item.TaxCode);
                        $("#cboTaxType@(itemName)").val(item.TaxType);
                        $("#txtTaxRate@(itemName)").val(item.TaxRate);


                        $("#txtUiNo@(itemName)").val(item.UiNo);
                        $("#txtInvoiceDate@(itemName)").val(item.InvoiceDate);
                        $("#txtInvoiceNo@(itemName)").val(item.InvoiceNo);

                        $("#txtApplyYYMM@(itemName)").val(item.ApplyYYMM.substr(0, 4) + "-" + item.ApplyYYMM.substr(4, 2));
                        $("#cboDepartmentNo@(itemName)").val(item.DepartmentNo.trim());
                        $("#cboInvoiceType@(itemName)").val(item.InvoiceType);
                        $("#cboDeductType@(itemName)").val(item.DeductType);
                        $("#cboCurrencyCode@(itemName)").val(item.CurrencyCode);
                        $("#txtExchange@(itemName)").val(item.Exchange);
                        $("#txtSupplierSo@(itemName)").val(item.SupplierSo);
                        $("#txtRowCnt@(itemName)").val(item.RowCnt);
                        $("#cboPaymentTerm@(itemName)").val(item.PaymentTerm);
                        if (item.AutoMaterialBilling == "Y") {
                            $("#cbxAutoMaterialBilling@(itemName)").attr("checked", true);
                        } else {
                            $("#cbxAutoMaterialBilling@(itemName)").attr("checked", false);
                        };
                        if (item.SupplierPicking == "Y") {
                            $("#cbxSupplierPicking@(itemName)").attr("checked", true);
                        } else {
                            $("#cbxSupplierPicking@(itemName)").attr("checked", false);
                        };

                        //原幣金額
                        var OrigAmount = parseInt(item.OrigAmount)
                        var OrigPreTaxAmount = parseInt(item.OrigPreTaxAmount)
                        var DeductAmount = parseInt(item.DeductAmount)
                        var OrigTax = parseInt(item.OrigTax)
                        var OriginalAmountTotal = parseInt(OrigAmount - DeductAmount + OrigTax)
                        //本幣金額
                        var OrigTax = parseInt(item.OrigTax)
                        var ReceiptAmount = parseInt(item.ReceiptAmount)
                        var PretaxAmount = parseInt(item.PretaxAmount)
                        var TaxAmount = parseInt(item.TaxAmount)
                        var LocalAmountTotal = parseInt(PretaxAmount + TaxAmount)

                        $("#txtOrigAmount@(itemName)").val(OrigAmount); //原幣加工金額
                        $("#txtOrigPreTaxAmount@(itemName)").val(OrigPreTaxAmount); //原幣未稅金額
                        $("#txtDeductAmount@(itemName)").val(DeductAmount); //原幣扣款金額
                        $("#txtOrigPreTaxAmount@(itemName)").val(OrigTax); //原幣稅額
                        $("#txtOriginalAmountTotal@(itemName)").val(OriginalAmountTotal); //原幣金額合計
                        $("#txtReceiptAmount@(itemName)").val(ReceiptAmount); //本幣進貨費用
                        $("#txtPretaxAmount@(itemName)").val(PretaxAmount); //本幣未稅金額
                        $("#txtTaxAmount@(itemName)").val(TaxAmount); //本幣稅額
                        $("#txtLocalAmountTotal@(itemName)").val(LocalAmountTotal); //本幣金額合計
                        $("#txtQuantity@(itemName)").val(item.Quantity); //數量合計

                    });
                        ExpandMweDetail(ScrapRegister);
                } else {
                    alert(data.msg, "alert", 0);
                }
            }

            //下拉選單樣式
            if (!isMobile) {
                $(`#cboMweErpPrefix@(itemName), #cboSupplierId@(itemName), #cboMweErpPrefix@(itemName), #cboPaymentTerm@(itemName), #cboDepartmentNo@(itemName)`).select2
                ({
                    dropdownAutoWidth: true,
                    width: "100%"
                });
            }
        }

        //編輯儲存
        function Save@(itemName)() {
            if (companyId@(itemName) == 3) {
                if ($("#cboMweErpPrefix@(itemName)").val() == "5901") {
                    alert("5901單別暫時不能使用")
                    return
                }
            }

            if ($(objForm@(itemName)).valid()) {
                let MweId = parseInt($("#MweId").val());
                if (MweId <= 0) {
                    //新增製令
                    let targetUrl = "@Url.Action("AddMoWarehouseEnry", "Inventory")";
                    let postData = {
                        "ViewCompanyId": companyId@(itemName),
                        "DocDate": $("#txtDocDate@(itemName)").val(),
                        "ReceiptDate": $("#txtReceiptDate@(itemName)").val(),
                        "MweErpPrefix": $("#cboMweErpPrefix@(itemName)").val(),
                        "MweErpNo": $("#txtMweErpNo@(itemName)").val(),
                        "SupplierId": $("#cboSupplierId@(itemName)").val(),
                        "Remark": $("#txtRemark@(itemName)").val(),
                        "TaxCode":$("#cboTaxCode@(itemName)").val(),
                        "TaxType": $("#cboTaxType@(itemName)").val(),
                        "TaxRate": $("#txtTaxRate@(itemName)").val(),
                        "UiNo": $("#txtUiNo@(itemName)").val(),
                        "InvoiceDate": $("#txtInvoiceDate@(itemName)").val(),
                        "InvoiceNo": $("#txtInvoiceNo@(itemName)").val(),
                        "ApplyYYMM": $("#txtApplyYYMM@(itemName)").val(),
                        "DepartmentNo": $("#cboDepartmentNo@(itemName)").val(),
                        "InvoiceType": $("#cboInvoiceType@(itemName)").val(),
                        "DeductType": $("#cboDeductType@(itemName)").val(),
                        "CurrencyCode": $("#cboCurrencyCode@(itemName)").val(),
                        "Exchange": $("#txtExchange@(itemName)").val(),
                        "SupplierSo": $("#txtSupplierSo@(itemName)").val(),
                        "RowCnt": $("#txtRowCnt@(itemName)").val(),
                        "PaymentTerm": $("#cboPaymentTerm@(itemName)").val(),
                        "AutoMaterialBilling": ($("#cbxAutoMaterialBilling@(itemName)").is(":checked") ? "Y" : "N"),
                        "SupplierPicking": ($("#cbxSupplierPicking@(itemName)").is(":checked") ? "Y" : "N"),
                    };

                    let data = DataAccess.EditContinued(targetUrl, postData, false);

                    if (data) {
                        $.each(data.result, function (i, item) {
                            $("#MweId").val(item.MweId);
                            $("#txtMweErpNo@(itemName)").val(item.MweErpNo);
                            $("#cboSupplierId@(itemName)").val(item.SupplierId);
                            if (item.MweErpPrefix == "5902" || item.MweErpPrefix == "5903") {
                                $("#MoneyDataShow").val("Y");
                            }
                            else {
                                $("#MoneyDataShow").val("N");
                            }
                            $("#cboMweErpPrefix@(itemName)").attr("disabled", true);
                            $("#cboSupplierId@(itemName)").attr("disabled", true);
                        });
                        ExpandMweDetail();
                    }
                }
                else {
                    //修改製令
                    let targetUrl = "@Url.Action("UpdateMoWarehouseEnry", "Inventory")";
                    let postData = {
                        "MweId": MweId,
                        "DocDate": $("#txtDocDate@(itemName)").val(),
                        "Remark": $("#txtRemark@(itemName)").val(),
                        "InvoiceDate": $("#txtInvoiceDate@(itemName)").val(),
                        "InvoiceNo": $("#txtInvoiceNo@(itemName)").val(),
                        "DepartmentNo": $("#cboDepartmentNo@(itemName)").val(),
                        "DeductType": $("#cboDeductType@(itemName)").val(),
                        "SupplierSo": $("#txtSupplierSo@(itemName)").val(),
                        "RowCnt": $("#txtRowCnt@(itemName)").val(),
                        "PaymentTerm": $("#cboPaymentTerm@(itemName)").val(),
                        "AutoMaterialBilling": ($("#cbxAutoMaterialBilling@(itemName)").is(":checked") ? "Y" : "N"),
                        "SupplierPicking": ($("#cbxSupplierPicking@(itemName)").is(":checked") ? "Y" : "N"),
                    };

                    let result = DataAccess.Update(targetUrl, postData, false, true);

                    if (result) {
                        ExpandMweDetail();
                    }
                }
            }
        }



        //拋轉+核單
        function TransferAndConfirm@(itemName)(MweId) {
            alert("功能暫時不能使用")
            return

            var MweIdNow = -1
                if (MweId == -1) {
                    MweIdNow = $("#MweId").val()
                }
                else if (MweId > 0) {
                    MweIdNow = MweId
            }

            swal.fire({
                titleText: "入庫單是否要拋轉+確認嗎?",
                text: "此動作會拋轉ERP+確認單據，請確認是否要執行!",
                icon: "warning",
                allowOutsideClick: false,
                allowEscapeKey: false,
                showCancelButton: true,
                confirmButtonColor: '#d33',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    let targetUrl = "@Url.Action("UpdateMweToERP", "Inventory")";
                    let postData = {
                        "MweId": MweIdNow
                    };

                    let result = DataAccess.Other(targetUrl, postData, false, true);

                    if (result) {
                        $("#MweStatus").val("C")
                        $("#TransferErp").hide()
                        $("#ConfirmErp").hide()
                        $("#ReConfirmErp").show()
                        Query@(itemName)();
                        QueryMweDetail();
                    }
                }
            });
        }
        //拋轉+核單
        //拋轉
        function TransferErp@(itemName)(MweId) {

            var MweIdNow = -1
            if (MweId == -1) {
                MweIdNow = $("#MweId").val()
            }
            else if (MweId > 0) {
                MweIdNow = MweId
            }


            swal.fire({
                titleText: "入庫單是否要拋轉嗎?",
                text: "此動作會拋轉ERP，請確認是否要執行!",
                icon: "warning",
                allowOutsideClick: false,
                allowEscapeKey: false,
                showCancelButton: true,
                confirmButtonColor: '#d33',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    let targetUrl = "@Url.Action("AddMweToERP", "Inventory")";
                    let postData = {
                        "MweId": MweIdNow
                    };

                    let data = DataAccess.EditContinued(targetUrl, postData, false);
                    if (data) {

                        $("#MweStatus").val("TP")
                        $("#TransferErp").hide()
                        $("#ConfirmErp").show()
                        $("#ReConfirmErp").hide()
                        $(".read-status").hide()

                        $.each(data.result, function (i, item) {
                            $("#txtMweErpNo@(itemName)").val(item.MweErpNo);
                        });

                        Query@(itemName)();
                        QueryMweDetail();

                        $('#txtDocDate@(itemName),#txtInvoiceDate@(itemName)').dateDropper('destroy');
                        $("#txtDocDate@(itemName)").attr("readonly", true);
                        $("#txtRemark@(itemName)").attr("readonly", true);
                        $("#cboDeductType@(itemName)").attr("disabled", true);
                        $("#txtInvoiceDate@(itemName)").attr("readonly", true);
                        $("#txtInvoiceNo@(itemName)").attr("readonly", true);
                        $("#cboDepartmentNo@(itemName)").attr("disabled", true);
                        $("#txtRowCnt@(itemName)").attr("readonly", true);
                        $("#txtSupplierSo@(itemName)").attr("readonly", true);
                        $("#cboPaymentTerm@(itemName)").attr("disabled", true);
                        $("#cbxAutoMaterialBilling@(itemName)").attr("disabled", true);
                        $("#cbxSupplierPicking@(itemName)").attr("disabled", true);

                        alert("拋轉成功", "success")
                    }
                }
            });
        }
        //拋轉

        //單據重新編輯
        function UpdateReConfirmStatus@(itemName)(MweId) {

            var MweIdNow = -1
                if (MweId == -1) {
                    MweIdNow = $("#MweId").val()
                }
                else if (MweId > 0) {
                    MweIdNow = MweId
            }
            var nowStatus = GetReConfirmStatus(MweId)

            if (nowStatus != "N") {
                if (nowStatus == "Y") {
                    alert("【入庫單重新編輯功能】該單據位目前處於可以編輯狀態")
                    return
                }
                alert("【入庫單重新編輯功能】該單據位必須曾經有反確認過並且重新拋轉後才能使用,或是狀態有問題")
                return
            }

            swal.fire({
                titleText: "入庫單是否要重新編輯嗎?",
                text: "請確認是否要執行!",
                icon: "warning",
                allowOutsideClick: false,
                allowEscapeKey: false,
                showCancelButton: true,
                confirmButtonColor: '#d33',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    let targetUrl = "@Url.Action("UpdateReConfirmStatus", "Inventory")";
                    let postData = {
                        "MweId": MweIdNow
                    };

                    let result = DataAccess.Other(targetUrl, postData, false, true);

                    if (result) {
                        $("#MweStatus").val("S")
                        $("#TransferErp").show()
                        $("#ConfirmErp").hide()
                        $("#ReConfirmErp").hide()
                        $(".read-status").show()
                        Query@(itemName)();
                        QueryMweDetail();

                        Suites.DateDropper("#txtDocDate@(itemName),#txtInvoiceDate@(itemName)");
                        $("#txtDocDate@(itemName)").attr("readonly", false);
                        $("#txtRemark@(itemName)").attr("readonly", false);
                        $("#cboDeductType@(itemName)").attr("disabled", false);
                        $("#txtInvoiceDate@(itemName)").attr("readonly", false);
                        $("#txtInvoiceNo@(itemName)").attr("readonly", false);
                        $("#cboDepartmentNo@(itemName)").attr("disabled", false);
                        $("#txtRowCnt@(itemName)").attr("readonly", false);
                        $("#txtSupplierSo@(itemName)").attr("readonly", false);
                        $("#cboPaymentTerm@(itemName)").attr("disabled", false);
                        $("#cbxAutoMaterialBilling@(itemName)").attr("disabled", false);
                        $("#cbxSupplierPicking@(itemName)").attr("disabled", false);
                    }
                }
            });
        }
        //單據重新編輯


        //確認
        function Confirm@(itemName)(MweId, ConfirmModel) {

            var MweIdNow = -1
                if (MweId == -1) {
                    MweIdNow = $("#MweId").val()
                }
                else if (MweId > 0) {
                    MweIdNow = MweId
            }
            var nowStatus = GetReConfirmStatus(MweId)

            if (nowStatus != "N") {
                if (nowStatus == "Y") {
                    alert("請先拋轉入庫單到ERP才能核單!")
                    return
                }
                alert("入庫單具狀態異常,不可以執行核單")
                return
            }


            swal.fire({
                titleText: "入庫單是否要確認嗎?",
                text: "此動作會確認單據，請確認是否要執行!",
                icon: "warning",
                allowOutsideClick: false,
                allowEscapeKey: false,
                showCancelButton: true,
                confirmButtonColor: '#d33',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    let targetUrl = "@Url.Action("UpdateMweERPConfirm", "Inventory")";
                    let postData = {
                        "MweId": MweIdNow,
                        "ConfirmModel": ConfirmModel
                    };

                    let result = DataAccess.Other(targetUrl, postData, false, true);

                    if (result) {
                        $("#MweStatus").val("C")
                        $("#TransferErp").hide()
                        $("#ConfirmErp").hide()
                        $("#ReConfirmErp").show()
                        Query@(itemName)();
                        QueryMweDetail();


                    }
                }
            });
        }
        //確認

        //反確認
        function ReConfirm@(itemName)(MweId, ConfirmModel) {

            var MweIdNow = -1
            if (MweId == -1) {
                MweIdNow = $("#MweId").val()
            }
            else if (MweId > 0) {
                MweIdNow = MweId
            }

            if (GetCheckoutStatus(MweIdNow) == "N") {
                return
            }


            swal.fire({
                titleText: "入庫單是否要反確認嗎?",
                text: "此動作會取消確認，請確認是否要執行!",
                icon: "warning",
                allowOutsideClick: false,
                allowEscapeKey: false,
                showCancelButton: true,
                confirmButtonColor: '#d33',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    let targetUrl = "@Url.Action("UpdateMweReconfirm", "Inventory")";
                    let postData = {
                        "MweId": MweIdNow,
                        "ConfirmModel": ConfirmModel
                    };

                    let result = DataAccess.Other(targetUrl, postData, false, true);

                    if (result) {
                        $("#MweStatus").val("S")
                        $("#TransferErp").show()
                        $("#ConfirmErp").hide()
                        $("#ReConfirmErp").hide()
                        $(".read-status").show()
                        Query@(itemName)();
                        QueryMweDetail();

                        Suites.DateDropper("#txtDocDate@(itemName),#txtInvoiceDate@(itemName)");
                        $("#txtDocDate@(itemName)").attr("readonly", false);
                        $("#txtRemark@(itemName)").attr("readonly", false);
                        $("#cboDeductType@(itemName)").attr("disabled", false);
                        $("#txtInvoiceDate@(itemName)").attr("readonly", false);
                        $("#txtInvoiceNo@(itemName)").attr("readonly", false);
                        $("#cboDepartmentNo@(itemName)").attr("disabled", false);
                        $("#txtRowCnt@(itemName)").attr("readonly", false);
                        $("#txtSupplierSo@(itemName)").attr("readonly", false);
                        $("#cboPaymentTerm@(itemName)").attr("disabled", false);
                        $("#cbxAutoMaterialBilling@(itemName)").attr("disabled", false);
                        $("#cbxSupplierPicking@(itemName)").attr("disabled", false);
                    }
                }
            });
        }
        //反確認

        //刪除
        function Delete@(itemName)(MweId) {
            swal.fire({
                titleText: "確認要刪除嗎?",
                text: "此動作無法復原，請確認是否要執行!",
                icon: "warning",
                allowOutsideClick: false,
                allowEscapeKey: false,
                showCancelButton: true,
                confirmButtonColor: '#d33',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    let targetUrl = "@Url.Action("DeleteMoWarehouseEnry", "Inventory")";
                    let postData = {
                        "MweId": MweId,
                    };

                    let result = DataAccess.Delete(targetUrl, postData, false, true);

                    if (result) {
                        Query@(itemName)();
                    }
                }
            });
        }
        //刪除

        //列印
        function Print@(itemName)(MweId) {
            let targetUrl = "@Url.Action("MoWarehouseEnryDocDownload", "Inventory")";
            let postData = {
                "MweId": MweId
            };

            FileAccess.AjaxDownload(targetUrl, postData, false);

                        Query@(itemName)();
        }

        //作廢
        function MweVoid@(itemName)(MweId) {

            swal.fire({
                titleText: "確認要作廢嗎?",
                text: "此動作無法復原，請確認是否要執行!",
                icon: "warning",
                allowOutsideClick: false,
                allowEscapeKey: false,
                showCancelButton: true,
                confirmButtonColor: '#d33',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    let targetUrl = "@Url.Action("UpdateMweVoid", "Inventory")";
                    let postData = {
                        "MweId": MweId,
                        "OperateUserId": userId@(itemName),
                        "OperateCompanyId": companyId@(itemName)
                    };

                    let result = DataAccess.Other(targetUrl, postData, false, true);

                    if (result) {
                        Query@(itemName)();
                    }
                }
            });
        }

        //主頁列表單身彈跳
        function DetailData@(itemName)(source){
            let html = '';
            if (source) {
                let json = JSON.parse(source);

                for (let x = 0; x < json.data.length; x++) {
                    html += `<tr>
                                <td class="tbody-customized">${x+1}</td>
                                <td class="tbody-customized">${json.data[x].WoErpFullNo}</td>
                                <td class="tbody-customized">${json.data[x].MtlItemNo}</td>
                                <td class="tbody-customized">${json.data[x].MtlItemName}</td>
                                <td class="tbody-customized">${json.data[x].InventoryNo + json.data[x].InventoryName}</td>
                                <td class="tbody-customized">${json.data[x].ReceiptQty}</td>
                             </tr>`;
                }
            }

            return html;
        }

        function Detail@(itemName)(MweId) {
            if ($(`tr[data-wo-id=${MweId}]`).css("display") == "none") {
                $("tr[data-wo-id]").hide();
                $(`tr[data-wo-id=${MweId}] tbody`).html("");
                $(`tr[data-wo-id=${MweId}]`).show();
                $(`tr[data-wo-id=${MweId}] tbody`).html(GetMweDetailListData@(itemName)(MweId))
            } else {
                $("tr[data-wo-id]").hide();
            }
        }
        //主頁列表單身彈跳

        function GetMweDetailListData@(itemName)(MweId) {
            let html = '';

            let targetUrl = "@Url.Action("GetMweDetailListData", "Inventory")";
            let postData = {
                "MweId": MweId
            };
            let data = DataAccess.Get(targetUrl, postData, false);
            if (data.status == "success") {
                $.each(data.result, function (i, item) {
                    html += `<tr>
                                <td class="tbody-customized">${1+i}</td>
                                <td class="tbody-customized">${item.FullErp}</td>
                                <td class="tbody-customized">${item.MtlItemNo}</td>
                                <td class="tbody-customized">${item.MtlItemName}</td>
                                <td class="tbody-customized">${item.InventoryNo + item.InventoryName}</td>
                                <td class="tbody-customized">${item.ReceiptQty}</td>
                             </tr>`;
                });
                return html

            } else {
                alert(data.msg, "alert", 0);
            }
        }




        //檢查是否有反確認過
        function GetReConfirmStatus(MweId) {
            if (MweId == -1) {
                MweId = $("#MweId").val()
            }

            let targetUrl = "@Url.Action("GetReConfirmStatus", "Inventory")";
            let postData = {
                "MweId": MweId
            };
            var ReConfirmStatus =""
            let data = DataAccess.Get(targetUrl, postData, false);
            if (data.status == "success") {
                $.each(data.result, function (i, item) {
                    ReConfirmStatus = item.ReConfirmStatus;
                    $("#ScrapRegister").val(item.ScrapRegister);
                });

            } else {
                alert(data.msg, "alert", 0);
            }
            return ReConfirmStatus
        }

        //檢查是否已經結帳
        function GetCheckoutStatus(MweId) {
            var erro ="Y"
            let targetUrl = "@Url.Action("GetCheckoutStatus", "Inventory")";
            let postData = {
                "MweId": MweId
            };
            var ReConfirmStatus =""
            let data = DataAccess.Get(targetUrl, postData, false);
            if (data.status == "success") {
            } else {
                alert(data.msg, "alert", 0);
                return erro = "N"
            }
        }

        function GetUserInfo@(itemName)() {
            let targetUrl = "@Url.Action("GetLoginByKey", "User")";
            let postData = {
                "UserNo": $.cookie("Login"),
                "KeyText": $.cookie("LoginKey")
            };

            let data = DataAccess.Get(targetUrl, postData, false);

            if (data.status == "success") {
                userId@(itemName) = data.returnData.UserId;
                companyId@(itemName) = data.returnData.CompanyId;
                userNo@(itemName) = data.returnData.UserNo;

            } else {
                alert(data.msg, "alert", 0);
            }
        }

        var ConfirmStatusList = [];
        var BooleanList = [];
        function InputStatusContent(Type, Status, Value) {
            switch (Type) {
                case "S":
                    switch (Status) {
                        case "ConfirmStatus":
                            if (ConfirmStatusList.length <= 0) {
                                let targetUrl = "@Url.Action("GetInputStatusContent", "Production")";
                                let postData = {
                                    "Type": Type,
                                    "StatusSchema": "ConfirmStatus"
                                };
                                let data = DataAccess.Get(targetUrl, postData, false);
                                if (data.status == "success") {
                                    $.each(data.result, function (i, item) {
                                        ConfirmStatusList.push(item.StatusNo+","+item.StatusName)
                                    });
                                } else {
                                    alert(data.msg, "alert", 0);
                                    return
                                }
                            }
                            var StatusName = "";
                            ConfirmStatusList.forEach(function (v) {
                                if (v.split(',')[0] == Value) {
                                    StatusName = v.split(',')[1]
                                }
                            })
                            return StatusName
                            break
                        case "TransferStatus":
                            if (BooleanList.length <= 0) {
                                let targetUrl = "@Url.Action("GetInputStatusContent", "Production")";
                                let postData = {
                                    "Type": Type,
                                    "StatusSchema": "Boolean"
                                };
                                let data = DataAccess.Get(targetUrl, postData, false);
                                if (data.status == "success") {
                                    $.each(data.result, function (i, item) {
                                        BooleanList.push(item.StatusNo+","+item.StatusName)
                                    });
                                } else {
                                    alert(data.msg, "alert", 0);
                                    return
                                }
                            }
                            var StatusName = "";
                            BooleanList.forEach(function (v) {
                                if (v.split(',')[0] == Value) {
                                    StatusName = v.split(',')[1]
                                }
                            })
                            return StatusName
                            break
                    }
                    break
                case "T":
                    break
            }

        }

        function ExcelProjectOutCycle@(itemName)() {

            var StartReceiptDateQ = $("#txtStartDocDateProjectOutCycleQ@(itemName)").val();
            var EndReceiptDateQ = $("#txtEndDocDateProjectOutCycleQ@(itemName)").val();


            if (StartReceiptDateQ.length <= 0 && EndReceiptDateQ.length <= 0) {
                alert("搜尋視窗的選擇日期不能為空，不能列印");
                return
            }
            else {
                let targetUrl = "@Url.Action("ExcelProjectOutCycle", "MesReport")";
                let postData = {
                    "StartReceiptDate": StartReceiptDateQ,
                    "EndReceiptDate": EndReceiptDateQ,
                    "ConfirmStatusProjectOutCycle": $("#cbConfirmStatusProjectOutCycleQ@(itemName)").val(),//確認狀態
                    "CheckoutStatusProjectOutCycle": $("#cboCheckoutStatusProjectOutCycleQ@(itemName)").val()//結帳狀態
                };

                let data = DataAccess.EditContinued(targetUrl, postData, false);

                if (data) {
                    alert("匯出成功!!!!", "success");
                    FileAccess.AjaxDownload(targetUrl, postData, false);
                }
            }
        }


        function Return@(itemName)() {
            ResetForm(objForm@(itemName));
            Switch("#listData@(itemName)", "#editData@(itemName), .unit-block, .advanced-block");
            $('#txtDocDate@(itemName)').dateDropper('destroy');
            $('#txtReceiptDate@(itemName)').dateDropper('destroy');
            $("#TransferErp").show()
            $("#ConfirmErp").hide()
            $("#ReConfirmErp").hide()
            $("#TransferStatus").val("")
            $("#SupplierNo").val("")
            Query@(itemName)();
        }
</script>
)